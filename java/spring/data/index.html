<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>第 8 章 Spring Data</title><link rel="stylesheet" type="text/css" href="../..//docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="../../index.html" title="Netkiller Java 手札" /><link rel="up" href="../index.html" title="部分 I. Spring Framework" /><link rel="prev" href="../restful/ch07s10.html" title="7.10. Timeout 超时设置" /><link rel="next" href="spring-data-redis.html" title="8.2. Spring Data Redis" /></head><body><a xmlns="" href="//www.netkiller.cn/">Home</a> |
		<a xmlns="" href="//netkiller.github.io/">简体中文</a> |
	    <a xmlns="" href="http://netkiller.sourceforge.net/">繁体中文</a> |
	    <a xmlns="" href="/journal/index.html">杂文</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/donations.html">打赏(Donations)</a> |
	    <a xmlns="" href="https://github.com/netkiller">Github</a> |
	    <a xmlns="" href="http://my.oschina.net/neochen/">OSChina 博客</a> |
	    <a xmlns="" href="https://cloud.tencent.com/developer/column/2078">云社区</a> |
	    <a xmlns="" href="https://yq.aliyun.com/u/netkiller/">云栖社区</a> |
	    <a xmlns="" href="https://www.facebook.com/bg7nyt">Facebook</a> |
	    <a xmlns="" href="http://cn.linkedin.com/in/netkiller/">Linkedin</a> |
	    <a xmlns="" href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/video.html">视频教程</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/about.html">About</a><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第 8 章 Spring Data</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="../restful/ch07s10.html">上一页</a> </td><th width="60%" align="center">部分 I. Spring Framework</th><td width="20%" align="right"> <a accesskey="n" href="spring-data-redis.html">下一页</a></td></tr></table><hr /></div><table xmlns=""><tr><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=watch&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=fork&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;type=follow&amp;count=true&amp;size=large" height="30" width="240" frameborder="0" scrolling="0" style="width:240px; height: 30px;" allowTransparency="true"></iframe></td></tr></table><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="index"></a>第 8 章 Spring Data</h2></div></div></div><div class="toc"><p><strong>目录</strong></p><dl class="toc"><dt><span class="section"><a href="index.html#idp378">8.1. Jackson</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#@JsonIgnore">8.1.1. @JsonIgnore 返回json是不含有该字段</a></span></dt><dt><span class="section"><a href="index.html#@JsonFormat 日期格式化">8.1.2. @JsonFormat 格式化 json 时间格式</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idp374">8.1.2.1. 日期格式化</a></span></dt><dt><span class="section"><a href="index.html#idp375">8.1.2.2. 时区</a></span></dt><dt><span class="section"><a href="index.html#idp376">8.1.2.3. 枚举</a></span></dt><dt><span class="section"><a href="index.html#idp377">8.1.2.4. 枚举</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="spring-data-redis.html">8.2. Spring Data Redis</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-redis.html#springdata.redis.exmaple">8.2.1. 集成 Redis</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-redis.html#idp379">8.2.1.1. pom.xml</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp380">8.2.1.2. springframework-servlet.xml</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp381">8.2.1.3. Controller</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp382">8.2.1.4. index.jsp</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp383">8.2.1.5. 测试</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-redis.html#RedisTemplate">8.2.2. RedisTemplate</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-redis.html#stringRedisTemplate">8.2.2.1. stringRedisTemplate 基本用法</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp384">8.2.2.2. 设置缓存时间</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp385">8.2.2.3. 字符串截取</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp386">8.2.2.4. 追加字符串</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp387">8.2.2.5. 设置键的字符串值并返回其旧值</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp388">8.2.2.6. increment</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#delete">8.2.2.7. 删除 key </a></span></dt><dt><span class="section"><a href="spring-data-redis.html#size">8.2.2.8. 返回字符串长度</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#setIfAbsent">8.2.2.9. 如果key不存便缓存。</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#multiSet">8.2.2.10. 缓存多个值 /获取多个值 multiSet / multiGet</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#list">8.2.2.11. List</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-redis.html#idp389">8.2.2.11.1. rightPush</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp390">8.2.2.11.2. rightPushAll</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp391">8.2.2.11.3. rightPushIfPresent</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp392">8.2.2.11.4. leftPush</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp393">8.2.2.11.5. leftPushAll</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp394">8.2.2.11.6. range</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-redis.html#set">8.2.2.12. SET ZSET 数据类型</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-redis.html#idp395">8.2.2.12.1. 返回集合中的所有成员</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp396">8.2.2.12.2. 取出一个成员</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp397">8.2.2.12.3. 随机获取无序集合中的一个元素</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp398">8.2.2.12.4. 随机获取 n 个成员（存在重复数据）</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp399">8.2.2.12.5. 随机获取 n 个不重复成员</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp400">8.2.2.12.6. 在两个 SET 间移动数据</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp401">8.2.2.12.7. 成员删除</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp402">8.2.2.12.8. 返回集合数量</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp403">8.2.2.12.9. 判断元素是否在集合成员中</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp404">8.2.2.12.10. 对比两个集合求交集</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp405">8.2.2.12.11. 对比两个集合求交集，然后存储到新的 key 中</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp406">8.2.2.12.12. 合并两个集合，并去处重复数据</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp407">8.2.2.12.13. 合并两个集合去重复后保存到新的 key 中</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp408">8.2.2.12.14. 计算两个合集的差集</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp409">8.2.2.12.15. 计算两个合集的差集，然后保存到新的 key 中</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp410">8.2.2.12.16. 遍历 SET 集合</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-redis.html#zset">8.2.2.13. 有序的 set 集合</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#hash">8.2.2.14. Hash</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-redis.html#idp411">8.2.2.14.1. put</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp412">8.2.2.14.2. putAll</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp413">8.2.2.14.3. 从键中的哈希获取给定hashKey的值</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp414">8.2.2.14.4. delete</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp415">8.2.2.14.5. 确定哈希hashKey是否存在</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp416">8.2.2.14.6. 从哈希中获取指定的多个 hashKey 的值</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp417">8.2.2.14.7. 只有hashKey不存在时才能添加值</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp418">8.2.2.14.8. 获取整个Hash</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp419">8.2.2.14.9. 获取所有key</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp420">8.2.2.14.10. 通过 hashKey 获取所有值</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp421">8.2.2.14.11. 值加法操作</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp422">8.2.2.14.12. 遍历 Hash 表</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-redis.html#redisTemplate.expire">8.2.2.15. 过期时间未执行</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp423">8.2.2.16. setBit / getBit 二进制位操作</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#JsonRedisTemplate">8.2.2.17. 存储 Json 对象</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-redis.html#idp424">8.2.2.17.1. 集成 RedisTemplate 定义新类 JsonRedisTemplate</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp425">8.2.2.17.2. 配置 Redis</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp426">8.2.2.17.3. 测试</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="spring-data-redis.html#RedisRepository">8.2.3. Spring Data Redis - Repository Examples</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-redis.html#idp427">8.2.3.1. @EnableRedisRepositories 启动 Redis 仓库</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp428">8.2.3.2. 定义 Domain 类</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp429">8.2.3.3. Repository 接口</a></span></dt><dt><span class="section"><a href="spring-data-redis.html#idp430">8.2.3.4. 测试代码</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="spring-data-mongodb.html">8.3. Spring Data MongoDB</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-mongodb.html#SpringDataMongoDB">8.3.1. Example Spring Data MongoDB</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-mongodb.html#idp431">8.3.1.1. pom.xml</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#idp432">8.3.1.2. springframework-servlet.xml</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#idp433">8.3.1.3. POJO</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#idp434">8.3.1.4. Controller</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#idp435">8.3.1.5. 查看测试结果</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#idp436">8.3.1.6. 条件查询</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-mongodb.html#@Document">8.3.2. @Document</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-mongodb.html#@Document">8.3.2.1. 指定表名</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#@Id">8.3.2.2. @Id</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#@Version">8.3.2.3. @Version</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#@Field">8.3.2.4. @Field 定义字段名</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#@Indexed">8.3.2.5. @Indexed</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-mongodb.html#idp437">8.3.2.5.1. 普通索引</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#idp438">8.3.2.5.2. 唯一索引</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#idp439">8.3.2.5.3. 索引排序方式</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#idp440">8.3.2.5.4. 稀疏索引</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#idp441">8.3.2.5.5. 索引过期时间设置</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-mongodb.html#@CompoundIndex">8.3.2.6. @CompoundIndex 复合索引</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-mongodb.html#idp442">8.3.2.6.1. 普通复合索引</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#idp443">8.3.2.6.2. 唯一复合索引</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-mongodb.html#@TextIndexed">8.3.2.7. @TextIndexed</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#@GeoSpatialIndex">8.3.2.8. @GeoSpatialIndex 地理位置索引</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#@Transient">8.3.2.9. @Transient 丢弃数据，不存到 mongodb</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#@DBRef">8.3.2.10. @DBRef 做外外键引用</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-mongodb.html#idp444">8.3.2.10.1. Article 类</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#idp445">8.3.2.10.2. Hypermedia 类</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#idp446">8.3.2.10.3. MongoRepository</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#idp447">8.3.2.10.4. RestController</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#idp448">8.3.2.10.5. 运行结果</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-mongodb.html#DateTimeFormat">8.3.2.11. @DateTimeFormat</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#NumberFormat">8.3.2.12. @NumberFormat</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#Enum">8.3.2.13. 在 @Document 中使用 Enum 类型</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#document.list">8.3.2.14. 在 @Document 中定义数据结构 List/Map</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#mongodb.geojson">8.3.2.15. GeoJson 数据类型</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-mongodb.html#MongoRepository">8.3.3. MongoRepository</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-mongodb.html#idp449">8.3.3.1. 扫描仓库接口</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#findAll">8.3.3.2. findAll()</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#deleteAll">8.3.3.3. deleteAll()</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#save">8.3.3.4. save()</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#count">8.3.3.5. count()</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#Repository.exists">8.3.3.6. exists() 判断是否存在</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#existsById">8.3.3.7. existsById()</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#findByXXXX">8.3.3.8. findByXXXX</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#findAllOrderBy">8.3.3.9. findAll with OrderBy</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-mongodb.html#idp450">8.3.3.9.1. order by boolean 布尔型数据排序</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-mongodb.html#findsort">8.3.3.10. findAll with Sort</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#findpage">8.3.3.11. FindAll with Pageable</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-mongodb.html#PageRequest">8.3.3.11.1. PageRequest - springboot 1.x 旧版本</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-mongodb.html#StartingWith">8.3.3.12. StartingWith 和 EndingWith</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#Between">8.3.3.13. Between</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#Before.After">8.3.3.14. Before / After</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#@Query">8.3.3.15. @Query</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-mongodb.html#mongoTemplate">8.3.4. mongoTemplate</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-mongodb.html#mongoTemplate.save">8.3.4.1. Save 保存</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#mongoTemplate.insert">8.3.4.2. Insert</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#mongoTemplate.updateFirst">8.3.4.3. updateFirst 修改符合条件第一条记录</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#mongoTemplate.updateMulti">8.3.4.4. updateMulti 修改符合条件的所有</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#mongoTemplate.findAndModify">8.3.4.5. 查找并保存</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#mongoTemplate.upsert">8.3.4.6. upsert - 修改符合条件时如果不存在则添加</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#mongoTemplate.remove">8.3.4.7. 删除</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#mongoTemplate.findOne">8.3.4.8. 查找一条数据</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#mongoTemplate.find">8.3.4.9. 查找所有数据</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#mongoTemplate.query">8.3.4.10. Query</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-mongodb.html#query.skip.limit">8.3.4.10.1. 翻页</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#between">8.3.4.10.2. between</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-mongodb.html#Criteria">8.3.4.11. Criteria</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-mongodb.html#Criteria.is">8.3.4.11.1. is</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#Criteria.regex">8.3.4.11.2. Regex 正则表达式搜索</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#Criteria.ltgt">8.3.4.11.3. lt 和 gt</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#Criteria.exists">8.3.4.11.4. exists()</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#Criteria.in">8.3.4.11.5. 包含</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-mongodb.html#Update">8.3.4.12. Update</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-mongodb.html#Update.set">8.3.4.12.1. set</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#Update.push">8.3.4.12.2. 追加数据</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#Update.update">8.3.4.12.3. 更新数据</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#Update.unset">8.3.4.12.4. 删除数据</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#Update.inc">8.3.4.12.5. inc</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#Update.addToSet">8.3.4.12.6. update.addToSet</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-mongodb.html#BasicUpdate">8.3.4.13. BasicUpdate</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#sort">8.3.4.14. Sort</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#PageRequest">8.3.4.15. Query + PageRequest</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#newAggregation">8.3.4.16. newAggregation</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#indexOps">8.3.4.17. 创建索引</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#mongoTemplate.subobject">8.3.4.18. 子对象操作</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-mongodb.html#idp451">8.3.4.18.1. List 类型</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="spring-data-mongodb.html#GeoJsonDeserializer">8.3.5. GeoJson 反序列化</a></span></dt><dt><span class="section"><a href="spring-data-mongodb.html#springbot.mongodb.faq">8.3.6. FAQ</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-mongodb.html#idp452">8.3.6.1. location object expected, location array not in correct format; nested exception is com.mongodb.MongoWriteException: location object expected, location array not in correct format</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="spring-data-jpa.html">8.4. Spring Data MySQL</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-jpa.html#engine">8.4.1. 选择数据库表引擎</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#@Entity">8.4.2. @Entity</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-jpa.html#@Table">8.4.2.1. @Table</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-jpa.html#catalog">8.4.2.1.1. catalog</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#schema">8.4.2.1.2. schema</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#uniqueConstraints">8.4.2.1.3. uniqueConstraints</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-jpa.html#@Id">8.4.2.2. @Id</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#@Column">8.4.2.3. @Column</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-jpa.html#idp453">8.4.2.3.1. 字段长度</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#idp454">8.4.2.3.2. 浮点型</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#idp455">8.4.2.3.3. 创建于更新控制</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#idp456">8.4.2.3.4. TEXT 类型</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-jpa.html#@Lob">8.4.2.4. @Lob 注解属性将被持久化为 Blog 或 Clob 类型</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#@NotNull">8.4.2.5. @NotNull 不能为空声明</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#@Temporal">8.4.2.6. @Temporal 日期定义</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#DateTimeFormat">8.4.2.7. @DateTimeFormat 处理日期时间格式</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#time">8.4.2.8. 默认时间规则</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-jpa.html#CreatedDate">8.4.2.8.1. CreatedDate</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#idp457">8.4.2.8.2. 与时间日期有关的 hibernate 注解</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-jpa.html#hibernate.time">8.4.2.8.2.1. 设置默认时间</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#createTime">8.4.2.8.2.2. 创建时间</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#updateTime">8.4.2.8.2.3. 更新时间</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-jpa.html#idp458">8.4.2.8.3. 数据库级别的默认创建日期时间定义</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#idp459">8.4.2.8.4. 数据库级别的默认创建日期与更新时间定义</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#idp460">8.4.2.8.5. 最后修改时间</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-jpa.html#index">8.4.2.9. 索引</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-jpa.html#">8.4.2.9.1. 普通索引</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#unique">8.4.2.9.2. 唯一索引</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#uniqueConstraints">8.4.2.9.3. 复合索引</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-jpa.html#enum">8.4.2.10. Enum 枚举数据类型</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-jpa.html#idp461">8.4.2.10.1. 实体中处理 enum 类型</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#idp462">8.4.2.10.2. 数据库枚举类型</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-jpa.html#set">8.4.2.11. SET 数据结构</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#UNSIGNED">8.4.2.12. 整形数据类型</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#json">8.4.2.13. JSON 数据类型</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#JoinColumn">8.4.2.14. @JoinColumn</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#OneToOne">8.4.2.15. @OneToOne</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#OneToMany">8.4.2.16. OneToMany 一对多</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#ManyToMany">8.4.2.17. ManyToMany 多对多</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#orphanRemoval">8.4.2.18. 外键级联删除</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#idp464">8.4.2.19. 其他</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-jpa.html#Cascade">8.4.2.19.1. Cascade</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#idp463">8.4.2.19.2. @JsonIgnore</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="spring-data-jpa.html#@Embeddable">8.4.3. 创建复合主键</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#@EnableJpaAuditing">8.4.4. @EnableJpaAuditing 开启 JPA 审计功能</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#Inheritance">8.4.5. 实体集成</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#Repository">8.4.6. Repository</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-jpa.html#CrudRepository">8.4.6.1. CrudRepository</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#JpaRepository">8.4.6.2. JpaRepository</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#jpa.find">8.4.6.3. findByXXX</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-jpa.html#idp465">8.4.6.3.1. 传 Boolean 参数</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#eunm">8.4.6.3.2. Eunm 传递枚举参数</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-jpa.html#jpa.count">8.4.6.4. count 操作</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#OrderBy">8.4.6.5. OrderBy</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#GreaterThan">8.4.6.6. GreaterThan</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#pageable">8.4.6.7. PageRequest 翻页操作</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-jpa.html#idp466">8.4.6.7.1. PageRequest.of</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#idp467">8.4.6.7.2. Pageable</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-jpa.html#sort">8.4.6.8. Sort 排序操作操作</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#Query">8.4.6.9. Query</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-jpa.html#idp468">8.4.6.9.1. 参数传递</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#idp469">8.4.6.9.2. 原生 SQL</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#idp470">8.4.6.9.3. @Query 与 Pageagble</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#idp471">8.4.6.9.4. 返回指定字段</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#idp472">8.4.6.9.5. 返回指定的模型</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-jpa.html#Transactional">8.4.6.10. @Transactional</a></span></dt><dd><dl><dt><span class="section"><a href="spring-data-jpa.html#idp473">8.4.6.10.1. 删除更新需要 @Transactional 注解</a></span></dt><dt><span class="section"><a href="spring-data-jpa.html#idp474">8.4.6.10.2. 回滚操作</a></span></dt></dl></dd><dt><span class="section"><a href="spring-data-jpa.html#@Lock">8.4.6.11. 锁 @Lock</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="EntityManager.html">8.5. EntityManager</a></span></dt><dt><span class="section"><a href="JdbcTemplate.html">8.6. JdbcTemplate</a></span></dt><dd><dl><dt><span class="section"><a href="JdbcTemplate.html#execute">8.6.1. execute</a></span></dt><dt><span class="section"><a href="JdbcTemplate.html#queryForInt">8.6.2. queryForInt</a></span></dt><dt><span class="section"><a href="JdbcTemplate.html#jdbcTemplate.queryForLong">8.6.3. queryForLong</a></span></dt><dt><span class="section"><a href="JdbcTemplate.html#queryForObject">8.6.4. queryForObject</a></span></dt><dd><dl><dt><span class="section"><a href="JdbcTemplate.html#idp475">8.6.4.1. 返回整形与字符型</a></span></dt><dt><span class="section"><a href="JdbcTemplate.html#idp476">8.6.4.2. 查询 Double 类型数据库</a></span></dt><dt><span class="section"><a href="JdbcTemplate.html#idp477">8.6.4.3. 返回日期</a></span></dt><dt><span class="section"><a href="JdbcTemplate.html#idp478">8.6.4.4. 返回结果集</a></span></dt><dt><span class="section"><a href="JdbcTemplate.html#idp479">8.6.4.5. 通过 "?" 向SQL传递参数</a></span></dt><dt><span class="section"><a href="JdbcTemplate.html#idp480">8.6.4.6. RowMapper 记录映射</a></span></dt></dl></dd><dt><span class="section"><a href="JdbcTemplate.html#queryForList">8.6.5. queryForList</a></span></dt><dt><span class="section"><a href="JdbcTemplate.html#queryForMap">8.6.6. queryForMap</a></span></dt><dt><span class="section"><a href="JdbcTemplate.html#query">8.6.7. query</a></span></dt><dd><dl><dt><span class="section"><a href="JdbcTemplate.html#idp481">8.6.7.1. ResultSet</a></span></dt><dt><span class="section"><a href="JdbcTemplate.html#idp482">8.6.7.2. ResultSetExtractor</a></span></dt><dt><span class="section"><a href="JdbcTemplate.html#idp483">8.6.7.3. RowMapper</a></span></dt></dl></dd><dt><span class="section"><a href="JdbcTemplate.html#queryForRowSet">8.6.8. queryForRowSet</a></span></dt><dt><span class="section"><a href="JdbcTemplate.html#update">8.6.9. update</a></span></dt><dt><span class="section"><a href="JdbcTemplate.html#">8.6.10. </a></span></dt><dt><span class="section"><a href="JdbcTemplate.html#jdbc.example">8.6.11. 实例参考</a></span></dt><dd><dl><dt><span class="section"><a href="JdbcTemplate.html#">8.6.11.1. 参数传递技巧</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="elasticsearch.html">8.7. Elasticsearch</a></span></dt><dd><dl><dt><span class="section"><a href="elasticsearch.html#idp490">8.7.1. 内嵌 Elasticsearch</a></span></dt><dd><dl><dt><span class="section"><a href="elasticsearch.html#idp484">8.7.1.1. Maven</a></span></dt><dt><span class="section"><a href="elasticsearch.html#idp485">8.7.1.2. src/main/resources/application.properties</a></span></dt><dt><span class="section"><a href="elasticsearch.html#idp486">8.7.1.3. Domain Class</a></span></dt><dt><span class="section"><a href="elasticsearch.html#idp487">8.7.1.4. ElasticsearchRepository</a></span></dt><dt><span class="section"><a href="elasticsearch.html#idp488">8.7.1.5. SearchRestController</a></span></dt><dt><span class="section"><a href="elasticsearch.html#idp489">8.7.1.6. 测试</a></span></dt></dl></dd><dt><span class="section"><a href="elasticsearch.html#idp491">8.7.2. 集群模式</a></span></dt><dt><span class="section"><a href="elasticsearch.html#idp492">8.7.3. Document</a></span></dt><dt><span class="section"><a href="elasticsearch.html#idp493">8.7.4. Elasticsearch 删除操作</a></span></dt><dt><span class="section"><a href="elasticsearch.html#faq">8.7.5. FAQ</a></span></dt><dd><dl><dt><span class="section"><a href="elasticsearch.html#idp494">8.7.5.1. java.lang.IllegalStateException: Received message from unsupported version: [2.0.0] minimal compatible version is: [5.0.0]</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="faq.html">8.8. Spring Data FAQ</a></span></dt><dd><dl><dt><span class="section"><a href="faq.html#idp495">8.8.1. No identifier specified for entity</a></span></dt><dt><span class="section"><a href="faq.html#idp496">8.8.2. Oracle Date 类型显示日期和时间</a></span></dt><dt><span class="section"><a href="faq.html#idp497">8.8.3. java.lang.ClassCastException: java.lang.Long cannot be cast to java.lang.Integer</a></span></dt><dt><span class="section"><a href="faq.html#idp498">8.8.4. Executing an update/delete query; nested exception is javax.persistence.TransactionRequiredException: Executing an update/delete query</a></span></dt></dl></dd></dl></div>
	

	
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp378"></a>8.1. Jackson</h2></div></div></div>
	
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="@JsonIgnore"></a>8.1.1. @JsonIgnore 返回json是不含有该字段</h3></div></div></div>
		
		<pre class="programlisting">
			
	@JsonIgnore
	private String entityName = this.getClass().getSimpleName();	
			
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="@JsonFormat 日期格式化"></a>8.1.2. @JsonFormat 格式化 json 时间格式</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp374"></a>8.1.2.1. 日期格式化</h4></div></div></div>
			

			<p>默认 json 中的时间格式是这样的</p>
			<pre class="screen">
			
"createDate":"2018-09-11T07:34:20.106+0000","updateDate":"2018-09-11T07:34:20.106+0000"			
			
			</pre>
			<p>@JsonFormat 可以格式化 json 返回的时间格式。</p>
			<pre class="programlisting">
			
@JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")			
			
			</pre>
			<p>格式化后</p>
			<pre class="programlisting">
			
"createDate":"2018-09-11 07:42:44","updateDate":"2018-09-11 07:42:44"			
			
			</pre>
			<p>解决时区问题，MongoDb 默认使用UTC,显示时间相差8小时</p>
			<pre class="programlisting">
			
@JsonFormat(timezone = "GMT+8", pattern = "yyyy-MM-dd HH:mm:ss")	
private Date createdDate = new Date();			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp375"></a>8.1.2.2. 时区</h4></div></div></div>
			
			<pre class="programlisting">
			
public class Test {
   @JsonFormat(shape=JsonFormat.Shape.STRING, pattern="yyyy-MMM-dd HH:mm:ss z", timezone="EST")
   @JsonProperty("pubDate")
   private Date recentBookPubDate;	
} 			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp376"></a>8.1.2.3. 枚举</h4></div></div></div>
			
			<pre class="programlisting">
			
public class Test {
   @JsonFormat(shape=JsonFormat.Shape.NUMBER)
   @JsonProperty("birthDate")
   private Date birthDate;
} 
			
			</pre>
			<pre class="screen">
			
{
  "birthDate" : 1528702883858
} 			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp377"></a>8.1.2.4. 枚举</h4></div></div></div>
			
			<pre class="programlisting">
			
package cn.netkiller;
import com.fasterxml.jackson.annotation.JsonFormat;

@JsonFormat(shape=JsonFormat.Shape.NUMBER)
enum Code {
    BLOCKING,
    CRITICAL,
    MEDIUM,
    LOW;
} 

@JsonFormat(shape=JsonFormat.Shape.STRING)
enum Lang {
	Java,
	PHP,
	Python
} 
			
			</pre>
		</div>
	</div>
</div>
	

	
	

	


	


	
	
</div><div xmlns="" id="disqus_thread"></div><script xmlns="">

var disqus_config = function () {
this.page.url = "http://www.netkiller.cn";  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = 'netkiller'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//netkiller.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script><noscript xmlns="">Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><br xmlns="" /><script xmlns="" type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?u=r5HG&amp;d=9mi5r_kkDC8uxG8HuY3p4-2qgeeVypAK9vMD-2P6BYM"></script><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="../restful/ch07s10.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="../index.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="spring-data-redis.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">7.10. Timeout 超时设置 </td><td width="20%" align="center"><a accesskey="h" href="../../index.html">起始页</a></td><td width="40%" align="right" valign="top"> 8.2. Spring Data Redis</td></tr></table></div><script xmlns="">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11694057-1', 'auto');
  ga('send', 'pageview');

</script><script xmlns="" async="async">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?93967759a51cda79e49bf4e34d0b0f2c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script xmlns="" async="async">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script><script xmlns="" type="text/javascript" src="/js/q.js" async="async"></script></body></html>