<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>5.7. Text Processing</title><link rel="stylesheet" type="text/css" href="..//docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><meta name="keywords" content="shell,bash,zsh, awk,sed,curl,expect, grep,sort" /><link rel="home" href="../index.html" title="Netkiller Linux Shell 手札" /><link rel="up" href="index.html" title="第 5 章 Shell command" /><link rel="prev" href="numeric.html" title="5.6. Numeric" /><link rel="next" href="grep.html" title="5.8. grep, egrep, fgrep, rgrep - print lines matching a pattern" /></head><body><a xmlns="" href="//www.netkiller.cn/">Home</a> |
		<a xmlns="" href="//netkiller.github.io/">简体中文</a> |
	    <a xmlns="" href="http://netkiller.sourceforge.net/">繁体中文</a> |
	    <a xmlns="" href="/journal/index.html">杂文</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/donations.html">打赏(Donations)</a> |
	    <a xmlns="" href="http://netkiller-github-com.iteye.com/">ITEYE 博客</a> |
	    <a xmlns="" href="http://my.oschina.net/neochen/">OSChina 博客</a> |
	    <a xmlns="" href="https://www.facebook.com/bg7nyt">Facebook</a> |
	    <a xmlns="" href="http://cn.linkedin.com/in/netkiller/">Linkedin</a> |
	    <a xmlns="" href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a> |
	    <a xmlns="" href="/search.html">Search</a> |
		<a xmlns="" href="mailto:netkiller@msn.com">Email</a><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5.7. Text Processing</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="numeric.html">上一页</a> </td><th width="60%" align="center">第 5 章 Shell command</th><td width="20%" align="right"> <a accesskey="n" href="grep.html">下一页</a></td></tr></table><hr /></div><table xmlns=""><tr><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=watch&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=fork&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;type=follow&amp;count=true&amp;size=large" height="30" width="240" frameborder="0" scrolling="0" style="width:240px; height: 30px;" allowTransparency="true"></iframe></td></tr></table><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="text"></a>5.7. Text Processing</h2></div></div></div>
	
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="iconv"></a>5.7.1. iconv - Convert encoding of given files from one encoding to another</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp70"></a>5.7.1.1. cconv - A iconv based simplified-traditional chinese conversion tool</h4></div></div></div>
			
			<p>cconv是建立在iconv之上，可以UTF8编码直接转换，并增加了词转换。</p>
			<pre class="screen">
sudo apt-get install cconv
			</pre>
			<p>使用cconv进行简繁转换的方法为：</p>
			<pre class="screen">
cconv -f UTF8-CN -t UTF8-HK zh-cn.txt -o zh-hk.txt
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp71"></a>5.7.1.2. uconv - convert data from one encoding to another</h4></div></div></div>
			
			<p>安装</p>
			<pre class="screen">
sudo apt-get install libicu-dev
			</pre>
			<p>例子</p>
			<pre class="screen">
$ uconv -f cp1252 -t UTF-8 -o file_in_utf8.txt file_in_cp1252_encoding.txt
			</pre>
		</div>
	</div>

	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="expr"></a>5.7.2. 字符串处理命令expr</h3></div></div></div>
		
		<pre class="screen">
		
字符串处理命令expr用法简介:
名称：expr
用途:求表达式变量的值。
语法: expr Expression
实例如下:
例子1:字串长度
shell&gt;&gt; expr length "this is a test content";
22
例子2:求余数
shell&gt;&gt; expr 20 % 9
2
例子3:从指定位置处截取字符串
shell&gt;&gt; expr substr "this is a test content" 3 5
is is
例子4:指定字符串第一次出现的位置
shell&gt;&gt; expr index "testforthegame" s
3
例子5:字符串真实重现
shell&gt;&gt; expr quote thisisatestformela
thisisatestformela
		
		</pre>
	</div>

	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="cat"></a>5.7.3. cat - concatenate files and print on the standard output</h3></div></div></div>
		
		<pre class="screen">
-b	不对空白行编号。
-e	使用 $ 字符显示行尾。
-n	从 1 开始对所有输出行编号。
-q	使用静默操作（禁止错误消息）。
-r	将所有多个空行替换为单行（“压缩”空白）。
-t	将制表符显示为 ^I。
-u	不对输出进行缓冲。
-v	可视地显示非打印控制字符。
		</pre>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp72"></a>5.7.3.1. -s, --squeeze-blank suppress repeated empty output lines</h4></div></div></div>
			
			<p>-S	将多个空白行压缩到单行中（与 -r 相同）</p>
			<pre class="screen">
			
$ cat &gt;&gt; /tmp/test &lt;&lt;EOF
Line1

Line2


Line3




Line4


Line5

EOF

$ cat -s /tmp/test
Line1

Line2

Line3

Line4

Line5

			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp73"></a>5.7.3.2. -v, --show-nonprinting   use ^ and M- notation, except for LFD and TAB</h4></div></div></div>
			
			<p>显示控制字符。例如Tab等，下面例子查看文件结尾换行符类型</p>
			<pre class="screen">
			
[neo@netkiller ~]# cat -v file.txt
GRANT USAGE ON *.* TO 'esauser'@'localhost' IDENTIFIED BY xxxxxxx; ^M
^M
file^M
2059^M
			
			</pre>
		</div>
	</div>

	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="nl"></a>5.7.4. nl - number lines of files</h3></div></div></div>
		
		<pre class="screen">
$ nl /etc/issue
     1  CentOS release 5.4 (Final)
     2  Kernel \r on an \m
		</pre>
	</div>

	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="od"></a>5.7.5. od - dump files in octal and other formats</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp74"></a>5.7.5.1. 16进制</h4></div></div></div>
			
			<pre class="screen">
$ echo "helloworld" | od -x
			</pre>
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="tr"></a>5.7.6. tr - translate or delete characters</h3></div></div></div>
		
		<p>":"替换为"\n"</p>
		<pre class="screen">
$ cat /etc/passwd |tr ":" "\n"
		</pre>
	</div>
    <div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="cut"></a>5.7.7. cut - remove sections from each line of files</h3></div></div></div>
        
        <p>列操作</p>
        <pre class="screen">
$ last | grep  'neo' | cut -d ' ' -f1
        </pre>
        <pre class="screen">
$ cat /etc/passwd | cut -d ':' -f1
root
daemon
bin
sys
sync
games
man
lp
mail
news
uucp
proxy

$ cat /etc/passwd | cut -d ':' -f1,3,4

# cat /etc/passwd | cut -d ':' -f1,6
root:/root
bin:/bin
daemon:/sbin
adm:/var/adm
lp:/var/spool/lpd
sync:/sbin
shutdown:/sbin
halt:/sbin
mail:/var/spool/mail
uucp:/var/spool/uucp
operator:/root
games:/usr/games
gopher:/var/gopher
ftp:/var/ftp
nobody:/
vcsa:/dev
saslauth:/var/empty/saslauth
postfix:/var/spool/postfix
sshd:/var/empty/sshd
rpc:/var/cache/rpcbind
rpcuser:/var/lib/nfs
nfsnobody:/var/lib/nfs
ntp:/etc/ntp
nagios:/var/log/nagios

        </pre>
        <p>行操作</p>
        <pre class="screen">
$ cat /etc/passwd | cut -c 1-4
root
daem
bin:
sys:
sync
game
man:

$ echo "No such file or directory"| cut -c4-7
such

$ echo "No such file or directory"| cut -c -8
No such

$ echo "No such file or directory"| cut -c-8
No such

        </pre>
    </div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="printf"></a>5.7.8. printf - format and print data</h3></div></div></div>
		
		<pre class="screen">
printf "%d\n" 1234
		</pre>
		<pre class="screen">
$ printf "\033[1;33m TEST COLOR \n\033[m"
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="recode"></a>5.7.9. Free `recode' converts files between various character sets and surfaces.</h3></div></div></div>
		
		<p>Following will convert text files between DOS, Mac, and Unix line ending styles:</p>
		<pre class="screen">
		
$ recode /cl../cr &lt;dos.txt &gt;mac.txt
$ recode /cr.. &lt;mac.txt &gt;unix.txt
$ recode ../cl &lt;unix.txt &gt;dos.txt
		
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="urandom"></a>5.7.10. /dev/urandom 随机字符串</h3></div></div></div>
		
		<pre class="screen">
		
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc A-Z-a-z-0-9 | head -c 8`
GidAuuNN
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc A-Z-a-z-0-9 | head -c 8`
UyGaWSKr
		
		</pre>
		<p>我常常使用这样的随机字符初始化密码</p>
		<pre class="screen">
		
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc [:alnum:] | head -c 8`
xig8Meym
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc [:alnum:] | head -c 8`
23Ac1vZg
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc [:digit:] | head -c 8`
73652314
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc [:graph:] | head -c 8`
GO_o&gt;OnJ
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc [:graph:] | head -c 10`
iGy0FS/aO5
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc [:graph:] | head -c 50`
;`E^{5(T4v~5$YovW.?%_?9la&lt;`+qPcRh@7mD\!Whx;MJZVQ\K
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc [:print:] | head -c 50`
fy$[#:'(')jt'gp1/g-)d~p]8 :r9i;MO2d!8M&lt;?Qs3t:QgK$O
[neo@test .deploy]$ echo `&lt; /dev/urandom tr -dc [:graph:] | head -c 50`
6SivJ5y$/FTi8mf}rrqE&amp;s0"WkA}r;uK-=MT!Wp0UlL_lF0|bL
		
		</pre>
		<p>批量生成</p>
		<pre class="screen">
		
for i in {1..10}
do
echo `&lt; /dev/urandom tr -dc A-Z-a-z-0-9 | head -c 8`
done
		
		</pre>
		<pre class="screen">
		
# cat /dev/urandom | tr -cd [:alnum:] | fold -w30 | head -n 20
AVqROzjF6ZATJGv2J6PzDHp3jLpKV4
ONt68UFNDwgXpSnLBV7oRDX3VLRYsX
EZTWCGvZc3mIEeuw9sxMtV8ZkzVRJv
BhUiv0a7utsjZFLYpKGZrY5aDXcZL4
5YfUl2hmDT1O9X61DRYg4wSp4lXoXX
ykyPJxH47PzxnNGlujIUF98ZtB01H0
QyP53mksQN8bCNNo1fSD3RtqhhEGfa
u2RkT1M9GUQF4a6O18tG5WD97OOXze
Whm5X7398Q8L9BONN8k2oLy9CL37JO
TmGQz7WB6WnkjhyB4wrBHBJ3HMIRyf
hww43yvddUDYUnbNOKjhv3sLhCA4YD
uY6zQtBC6miwLUl3jkCVVA0Xu8ASgj
jv58qu46VW7LvRIq4txNE8bG9NBlZl
pzaMkydAiCHCF5H2oQVqMn4DTTYgNL
yoN2A9LyrCwLfjP1ad9HMAwxExJL5i
J27iy2L90m9dpcPLJ8tl46GGb9xqmQ
6YwFCvuPHyyEwnctUTpqLFcvUafVZ2
Nuq9XgIgRQGynjlVqGLMOpO0MkGpsn
tChkRG7eoRuKVXgW7ccTGx45E54K3Y
qPv48XqdGlOrdULCOGZ45kwJ1v5kVX		
		
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="col"></a>5.7.11. col - filter reverse line feeds from input</h3></div></div></div>
		
		<p>清除 ^M 字符</p>
		<pre class="screen">
$ cat oldfile | col -b &gt; newfile
		</pre>
	</div>

	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="apg"></a>5.7.12. apg - generates several random passwords</h3></div></div></div>
		
		<pre class="screen">
sudo apt-get install apg

$ apg

Please enter some random data (only first 16 are significant)
(eg. your old password):&gt;
imlogNukcel5 (im-log-Nuk-cel-FIVE)
Drocdaf1 (Droc-daf-ONE)
fagJook0 (fag-Jook-ZERO)
heabugJer4 (heab-ug-Jer-FOUR)
5OsEsudy (FIVE-Os-Es-ud-y)
IrjOgneagOc9 (Irj-Og-neag-Oc-NINE)


$ apg -M SNCL -m 16
WoidWemFut6dryn,
byRowpEus-Flutt0
|QuogCagFaycsic0
ojHoadCyct4Freg_
Vir9blir`orhohoo
bapOip?Ibreawov2
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="head"></a>5.7.13. head/tail</h3></div></div></div>
		
		<pre class="screen">
head -c 17 | tail -c 1
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="rev"></a>5.7.14. 反转字符串或文件内容</h3></div><div><h4 class="subtitle">rev - reverse lines of a file or files</h4></div></div></div>
		
		
		<p>反转字符串 </p>
		<pre class="screen">
# echo hello | rev
olleh

# echo "hello world" | rev
dlrow olleh
		</pre>
		<p>反转文件内容 </p>
		<pre class="screen">
# rev /etc/passwd
hsab/nib/:toor/:toor:0:0:x:toor
nigolon/nibs/:nib/:nib:1:1:x:nib
nigolon/nibs/:nibs/:nomead:2:2:x:nomead
nigolon/nibs/:mda/rav/:mda:4:3:x:mda
nigolon/nibs/:dpl/loops/rav/:pl:7:4:x:pl
cnys/nib/:nibs/:cnys:0:5:x:cnys
nwodtuhs/nibs/:nibs/:nwodtuhs:0:6:x:nwodtuhs
tlah/nibs/:nibs/:tlah:0:7:x:tlah
nigolon/nibs/:liam/loops/rav/:liam:21:8:x:liam
nigolon/nibs/:pcuu/loops/rav/:pcuu:41:01:x:pcuu
nigolon/nibs/:toor/:rotarepo:0:11:x:rotarepo
nigolon/nibs/:semag/rsu/:semag:001:21:x:semag
nigolon/nibs/:rehpog/rav/:rehpog:03:31:x:rehpog
nigolon/nibs/:ptf/rav/:resU PTF:05:41:x:ptf
nigolon/nibs/:/:ydoboN:99:99:x:ydobon
nigolon/nibs/:ved/:renwo yromem elosnoc lautriv:96:96:x:ascv
nigolon/nibs/:ptn/cte/::83:83:x:ptn
nigolon/nibs/:htualsas/ytpme/rav/:"resu dhtualsaS":67:994:x:htualsas
nigolon/nibs/:xiftsop/loops/rav/::98:98:x:xiftsop
nigolon/nibs/:dhss/ytpme/rav/:HSS detarapes-egelivirP:47:47:x:dhss
hsab/nib/:lqsym/bil/rav/:revres LQSyM:994:894:x:lqsym
hsab/nib/:www/:noitacilppA beW:08:08:x:www
nigolon/nibs/:xnign/ehcac/rav/:resu xnign:894:794:x:xnign
		</pre>
	</div>
</div><div xmlns="" id="disqus_thread"></div><script xmlns="">

var disqus_config = function () {
this.page.url = "http://www.netkiller.cn";  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = 'netkiller'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//netkiller.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script><noscript xmlns="">Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><br xmlns="" /><script xmlns="" type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?u=r5HG&amp;d=9mi5r_kkDC8uxG8HuY3p4-2qgeeVypAK9vMD-2P6BYM"></script><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="numeric.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="index.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="grep.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">5.6. Numeric </td><td width="20%" align="center"><a accesskey="h" href="../index.html">起始页</a></td><td width="40%" align="right" valign="top"> 5.8. grep, egrep, fgrep, rgrep - print lines matching a pattern</td></tr></table></div><script xmlns="">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11694057-1', 'auto');
  ga('send', 'pageview');

</script><script xmlns="" async="async">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?93967759a51cda79e49bf4e34d0b0f2c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script xmlns="" async="async">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script><script xmlns="" type="text/javascript" src="/js/q.js" async="async"></script></body></html>