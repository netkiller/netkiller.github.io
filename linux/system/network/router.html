<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>11.10. Linux IP And Router</title><link rel="stylesheet" type="text/css" href="../../docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><meta name="keywords" content="&#10;&#9;&#9;&#9;&#9;bash,bunzip2,busybox,bzcat,bzcmp,bzdiff,bzegrep,bzexe,bzfgrep,bzgrep,bzip2,bzip2recover,bzless,bzmore,cat,chgrp,chmod,chown,chvt,cp,cpio,dash,date,dbus-cleanup-sockets,dbus-daemon,dbus-uuidgen,dd,df,dir,dmesg,dnsdomainname,domainname,dumpkeys,echo,ed,egrep,false,fgconsole,fgrep,fuser,fusermount,grep,gunzip,gzexe,gzip,hostname,ip,kbd_mode,kill,less,lessecho,lessfile,lesskey,lesspipe,ln,loadkeys,login,ls,lsmod,mkdir,mknod,mktemp,more,mount,mountpoint,mt,mt-gnu,mv,nano,nc,nc.openbsd,netcat,netstat,nisdomainname,ntfs-3g,ntfs-3g.probe,ntfs-3g.secaudit,ntfs-3g.usermap,open,openvt,pidof,ping,ping6,plymouth,ps,pwd,rbash,readlink,rm,rmdir,rnano,run-parts,sed,setfont,setupcon,sh,sh.distrib,sleep,static-sh,stty,su,sync,tailf,tar,tempfile,touch,true,ulockmgr_server,umount,uname,uncompress,unicode_start,vdir,which,ypdomainname,zcat,zcmp,zdiff,zegrep,zfgrep,zforce,zgrep,zless,zmore,znew,,/sbin/:,acpi_available,apm_available,apparmor_parser,badblocks,blkid,blockdev,bootlogd,cfdisk,crda,ctrlaltdel,debugfs,depmod,dhclient,dhclient3,dhclient-script,dmsetup,dosfsck,dosfslabel,dump,dumpe2fs,e2fsck,e2image,e2label,e2undo,ethtool,fdisk,findfs,fsck,fsck.cramfs,fsck.ext2,fsck.ext3,fsck.ext4,fsck.ext4dev,fsck.minix,fsck.msdos,fsck.nfs,fsck.vfat,fstab-decode,getty,halt,hdparm,hwclock,ifconfig,ifdown,ifquery,ifup,init,initctl,insmod,insserv,installkernel,ip,ip6tables,ip6tables-restore,ip6tables-save,ipmaddr,iptables,iptables-restore,iptables-save,iptunnel,isosize,iwconfig,iwevent,iwgetid,iwlist,iwpriv,iwspy,kbdrate,killall5,ldconfig,ldconfig.real,logsave,losetup,lsmod,MAKEDEV,mii-tool,mkdosfs,mke2fs,mkfs,mkfs.bfs,mkfs.cramfs,mkfs.ext2,mkfs.ext3,mkfs.ext4,mkfs.ext4dev,mkfs.minix,mkfs.msdos,mkfs.vfat,mkhomedir_helper,mkswap,modinfo,modprobe,mountall,mount.fuse,mount.nfs,mount.nfs4,mount.ntfs,mount.ntfs-3g,nameif,on_ac_power,pam_tally,parted,partprobe,pivot_root,plipconfig,plymouthd,pmap_dump,pmap_set,portmap,poweroff,rarp,raw,rdump,reboot,regdbdump,reload,resize2fs,restart,restore,rfkill,rmmod,route,rpc.statd,rrestore,rtacct,rtmon,runlevel,sfdisk,shadowconfig,showmount,shutdown,slattach,sm-notify,ss,start,startpar,start-stop-daemon,status,stop,sulogin,swapoff,swapon,switch_root,sysctl,tc,telinit,tune2fs,udevadm,udevd,umount.nfs,umount.nfs4,unix_chkpwd,unix_update,upstart-udev-bridge,ureadahead,wipefs,wpa_action,wpa_cli,wpa_supplicant&#10;&#9;&#9;&#9;, &#10;&#9;&#9;&#9;&#9;a2p,acyclic,addftinfo,addpart,afmtodit,animate,anytopnm,apg,apgbfm,apport-bug,apport-cli,apport-collect,apport-unpack,apropos,apt-cache,apt-cdrom,apt-config,apt-extracttemplates,apt-ftparchive,apt-get,aptitude,aptitude-create-state-bundle,aptitude-run-state-bundle,apt-key,apt-mark,apt-sortpkgs,arch,arping,asciitopgm,at,atktopbm,atq,atrm,awk,base64,basename,bashbug,batch,bc,bcomps,bconsole,bdftopcf,bdftops,bdftruncate,bioradtopgm,bmptopnm,bmptoppm,brushtopbm,bsd-mailx,bsd-write,byobu,byobu-config,byobu-export,byobu-janitor,byobu-launch,byobu-launcher,byobu-launcher-install,byobu-launcher-uninstall,byobu-reconnect-sockets,byobu-select-profile,byobu-select-session,byobu-status,byobu-status-detail,c2ph,cal,calendar,captoinfo,catchsegv,catman,cautious-launcher,ccomps,chage,chattr,chcon,check-bios-nx,check-language-support,chem,chfn,chkdupexe,chrt,chsh,circo,ckbcomp,ck-history,ck-launch-session,ck-list-sessions,cksum,clear,clear_console,cmp,cmuwmtopbm,codepage,col,colcrt,colrm,column,comm,compare,compose,composite,config_data,conjure,convert,corelist,cpan,cpan2dist,cpanp,cpanp-run-perl,cpp,cpp-4.4,createrepo,c_rehash,crontab,csplit,ctstat,curl,curlftpfs,cut,dbilogstrip,dbiprof,dbiproxy,dbmmanage,dbus-monitor,dbus-send,ddate,deallocvt,debconf,debconf-apt-progress,debconf-communicate,debconf-copydb,debconf-escape,debconf-set-selections,debconf-show,defoma,defoma-app,defoma-font,defoma-hints,defoma-id,defoma-psfont-installer,defoma-subst,defoma-user,delpart,dh_bash-completion,dh_installdefoma,dh_installxmlcatalogs,dh_pycentral,dh_pysupport,dialog,diff,diff3,diffimg,dig,dijkstra,dircolors,dirname,display,do-release-upgrade,dot,dot2gxl,dotlockfile,dotty,dpkg,dpkg-deb,dpkg-divert,dpkg-query,dpkg-split,dpkg-statoverride,dpkg-trigger,dprofpp,du,dumphint,dumpkeys,dvipdf,easy_install,easy_install-2.6,edit,editor,eject,enc2xs,encode_keychange,env,envsubst,eps2eps,epsffit,eqn,eqn2graph,ex,expand,expiry,expr,extractres,eyuvtoppm,factor,faillog,fallocate,fc-cache,fc-cat,fc-list,fc-match,fc-query,fc-scan,fdp,fiascotopnm,file,find,find2perl,findsmb,fitstopnm,fixdlsrps,fixfmps,fixmacps,fixproc,fixpsditps,fixpspps,fixscribeps,fixtpps,fixwfwps,fixwpps,fixwwps,flock,flow-capture,flow-cat,flow-dscan,flow-expire,flow-export,flow-fanout,flow-filter,flow-gen,flow-header,flow-import,flow-log2rrd,flow-mask,flow-merge,flow-nfilter,flow-print,flow-receive,flow-report,flow-rpt2rrd,flow-rptfmt,flow-send,flow-split,flow-stat,flow-tag,flow-xlate,fmt,fold,font2c,fontconfig-voodoo,fonttosfnt,fping,fping6,free,fribidi,from,fstopgm,ftp,funzip,g3topbm,gawk,gc,gdiffmk,gdk-pixbuf-query-loaders,gemtopbm,gemtopnm,gendiff,geqn,GET,getafm,getconf,getent,getkeycodes,getopt,gettext,gettext.sh,ghostscript,giftopnm,ginstall-info,gio-querymodules,git,git-receive-pack,git-shell,git-upload-archive,git-upload-pack,gmetric,gnokii,gnuplot,gnuplot-nox,gouldtoppm,gpasswd,gpg,gpgsplit,gpgv,gpg-zip,gpic,grap2graph,grn,grodvi,groff,groffer,grog,grolbp,grolj4,grops,grotty,groups,grub-bin2h,grub-editenv,grub-fstest,grub-mkelfimage,grub-mkfont,grub-mkimage,grub-mkisofs,grub-mkpasswd-pbkdf2,grub-mkrelpath,grub-mkrescue,grub-script-check,gs,gsbj,gsdj,gsdj500,gslj,gslp,gsnd,gstat,gtbl,gtk-query-immodules-2.0,gtk-update-icon-cache,gvcolor,gvimtutor,gvpack,gvpr,gxditview,gxl2dot,h2ph,h2xs,hd,head,HEAD,helpztags,hexdump,hipstopgm,host,hostid,hpftodit,htdbm,htdigest,htpasswd,i386,icontopbm,iconv,id,identify,igawk,ilbmtoppm,imgtoppm,import,includeres,indexer,indxbib,info,infobrowser,infocmp,infokey,infotocap,innochecksum,innotop,install,install-info,instmodsh,ionice,iostat,ipcmk,ipcrm,ipcs,ipmicmd,ipmilan,ipmish,ipmitool,ipmi_ui,iptables-xml,join,jpegtopnm,killall,kvm-ok,l4p-tmpl,landscape-sysinfo,last,lastb,lastlog,lcf,ldd,leaftoppm,lefty,less,lessecho,lessfile,lesskey,lesspipe,lexgrog,libnetcfg,line,link,linux32,linux64,linux-boot-prober,lispmtopgm,lkbib,lneato,lnstat,loadkeys,loadunimap,locale,localedef,locate,lockfile-check,lockfile-create,lockfile-remove,lockfile-touch,logger,logname,look,lookbib,lorder,lsattr,lsb_release,lscpu,lshw,lsof,lspci,lspgpot,lsusb,ltrace,lwp-download,lwp-dump,lwp-mirror,lwp-request,lwp-rget,lzcat,lzma,macptopbm,mail,Mail,mail-lock,mailq,mail-touchlock,mail-unlock,mailx,make,make-memtest86+-boot-floppy,make_method,man,mandb,manhole,manpath,mapscrn,mawk,mcookie,md5sum,md5sum.textutils,mdatopbm,memcached,mesg,mgrtopbm,mkfifo,mkfontdir,mkfontscale,mk_modmap,mktap,mlocate,mmroff,modifyrepo,mogrify,montage,motd+shell,mpstat,msql2mysql,mtr,mtvtoppm,munin-check,munin-cron,munindoc,mutt,mutt_dotlock,myisamchk,myisam_ftdump,myisamlog,myisampack,my_print_defaults,mysql,mysqlaccess,mysqladmin,mysqlanalyze,mysqlbinlog,mysqlbug,mysqlcheck,mysql_client_test,mysql_client_test_embedded,mysql_convert_table_format,mysqld_multi,mysqld_safe,mysqldump,mysqldumpslow,mysql_find_rows,mysql_fix_extensions,mysql_fix_privilege_tables,mysqlhotcopy,mysqlimport,mysql_install_db,mysqloptimize,mysqlrepair,mysqlreport,mysql_secure_installation,mysql_setpermission,mysqlshow,mysqlslap,mysqltest,mysqltest_embedded,mysql_tzinfo_to_sql,mysql_upgrade,mysql_waitpid,mysql_zap,mytop,namei,nano,nawk,ncal,ncat,ncftp,ncftp3,ncftpbatch,ncftpbookmarks,ncftpget,ncftpls,ncftpput,ncftpspooler,ncurses5-config,ncursesw5-config,ndiff,neato,neotoppm,neqn,net,netkit-ftp,net.samba3,net-snmp-config,netstat-nat,newaliases,newgrp,ngettext,nice,nl,nmap,nmblookup,nmblookup.samba3,nmon,nohup,nop,nroff,nslookup,nstat,nsupdate,od,oldfind,omshell,on_ac_power,openipmicmd,openipmish,openssl,openssl-vulnkey,os-prober,pager,palmtopnm,pamcut,pamdeinterlace,pamdice,pamfile,pamoil,pamstack,pamstretch,pamstretch-gen,paperconf,parsechangelog,partx,passwd,paste,patch,pathchk,pbmclean,pbmlife,pbmmake,pbmmask,pbmpage,pbmpscale,pbmreduce,pbmtext,pbmtextps,pbmto10x,pbmtoascii,pbmtoatk,pbmtobbnbg,pbmtocmuwm,pbmtoepsi,pbmtoepson,pbmtog3,pbmtogem,pbmtogo,pbmtoicon,pbmtolj,pbmtomacp,pbmtomda,pbmtomgr,pbmtonokia,pbmtopgm,pbmtopi3,pbmtoplot,pbmtoppa,pbmtopsg3,pbmtoptx,pbmtowbmp,pbmtox10bm,pbmtoxbm,pbmtoybm,pbmtozinc,pbmupc,pcimodules,pcretest,pcxtoppm,pdb,pdb2.6,pdb3,pdb3.1,pdf2dsc,pdf2ps,pdfopt,pdfroff,pear,peardev,pecl,peekfd,perl,perl5.10.1,perlbug,perldoc,perlivp,perlthanks,perror,pf2afm,pfbtopfa,pfbtops,pfc,pftp,pg,pgawk,pgmbentley,pgmcrater,pgmedge,pgmenhance,pgmhist,pgmkernel,pgmnoise,pgmnorm,pgmoil,pgmramp,pgmslice,pgmtexture,pgmtofs,pgmtolispm,pgmtopbm,pgmtoppm,pgrep,php,php5,pi1toppm,pi3topbm,pic,pic2graph,pico,piconv,pidstat,pinky,pip,pjtoppm,pkill,pl2pm,plog,pmap,pngtopnm,pnmalias,pnmarith,pnmcat,pnmcolormap,pnmcomp,pnmconvol,pnmcrop,pnmcut,pnmdepth,pnmenlarge,pnmfile,pnmflip,pnmgamma,pnmhisteq,pnmhistmap,pnmindex,pnminterp,pnminterp-gen,pnminvert,pnmmargin,pnmmontage,pnmnlfilt,pnmnoraw,pnmnorm,pnmpad,pnmpaste,pnmpsnr,pnmquant,pnmremap,pnmrotate,pnmscale,pnmscalefixed,pnmshear,pnmsmooth,pnmsplit,pnmtile,pnmtoddif,pnmtofiasco,pnmtofits,pnmtojpeg,pnmtopalm,pnmtoplainpnm,pnmtopng,pnmtops,pnmtorast,pnmtorle,pnmtosgi,pnmtosir,pnmtotiff,pnmtotiffcmyk,pnmtoxwd,pod2html,pod2latex,pod2man,pod2text,pod2usage,podchecker,podselect,poff,pon,POST,post-grohtml,ppm3d,ppmbrighten,ppmchange,ppmcie,ppmcolormask,ppmcolors,ppmdim,ppmdist,ppmdither,ppmfade,ppmflash,ppmforge,ppmhist,ppmlabel,ppmmake,ppmmix,ppmnorm,ppmntsc,ppmpat,ppmquant,ppmquantall,ppmqvga,ppmrainbow,ppmrelief,ppmshadow,ppmshift,ppmspread,ppmtoacad,ppmtobmp,ppmtoeyuv,ppmtogif,ppmtoicr,ppmtoilbm,ppmtojpeg,ppmtoleaf,ppmtolj,ppmtomap,ppmtomitsu,ppmtompeg,ppmtoneo,ppmtopcx,ppmtopgm,ppmtopi1,ppmtopict,ppmtopj,ppmtopuzz,ppmtorgb3,ppmtosixel,ppmtotga,ppmtouil,ppmtowinicon,ppmtoxpm,ppmtoyuv,ppmtoyuvsplit,ppmtv,pr,preconv,pre-grohtml,prename,print,printafm,printenv,printerbanner,printf,prove,prtstat,prune,ps2ascii,ps2epsi,ps2pdf,ps2pdf12,ps2pdf13,ps2pdf14,ps2pdfwr,ps2ps,ps2ps2,ps2txt,psbook,psed,psfaddtable,psfgettable,psfstriptable,psfxtable,psidtopgm,psmerge,psnup,psresize,psselect,pstopnm,pstops,pstree,pstree.x11,pstruct,ptar,ptardiff,ptx,pwdx,py3_compilefiles,pycentral,pyclean,pycompile,py_compilefiles,pydoc,pydoc2.6,pydoc3,pydoc3.1,pygettext,pygettext2.6,pygettext3,pygettext3.1,pyhtmlizer,python,python2,python2.6,python3,python3.1,pyversions,qrttoppm,rasttopnm,rawtopgm,rawtoppm,rcp,red,refer,rename,rename.ul,renice,replace,report-hw,reset,resolveip,resolve_stack_dump,rev,rgb3toppm,rgrep,rletopnm,rlogin,rmcp_ping,roff2dvi,roff2html,roff2pdf,roff2ps,roff2text,roff2x,routef,routel,rpcclient,rpcinfo,rpm,rpm2cpio,rpmbuild,rpmdb,rpmgraph,rpmquery,rpmsign,rpmverify,rrdcgi,rrdtool,rrdupdate,rsh,rsync,rtstat,runcon,run-mailcap,rview,rvim,s2p,sadf,sar,sar.sysstat,savelog,sbigtopgm,sccmap,scp,screen,screendump,screen-launcher,screen-profiles-status,script,scriptreplay,sdiff,search,searchd,see,select-editor,sendsms,sensible-browser,sensible-editor,sensible-pager,sensors,sensors-conf-convert,seq,service,setarch,setkeycodes,setleds,setlogcons,setmetamode,setpci,setsid,setterm,sftp,sg,sgitopnm,sha1sum,sha224sum,sha256sum,sha384sum,sha512sum,shasum,showchar,showconsolefont,showkey,shred,shuf,sirtopnm,skill,slabtop,sldtoppm,slogin,smbcacls,smbclient,smbcquotas,smbget,smbpasswd,smbspool,smbtar,smbtree,smime_keys,snice,snmpbulkget,snmpbulkwalk,snmpconf,snmpdelta,snmpdf,snmpget,snmpgetnext,snmpinform,snmpkey,snmpnetstat,snmpset,snmpstatus,snmptable,snmptest,snmptranslate,snmptrap,snmpusm,snmpvacm,snmpwalk,soelim,solterm,sort,spctoppm,spelldump,splain,split,splitfont,sputoppm,ssh,ssh-add,ssh-agent,ssh-argv0,ssh-copy-id,sshfs,ssh-keygen,ssh-keyscan,ssh-vulnkey,st4topgm,stat,strace,stream,sudo,sudoedit,sum,svn,svnadmin,svnauthz-validate,svndumpfilter,svnlook,svnmucc,svn-populate-node-origins-index,svnserve,svnsync,svnversion,tabs,tac,tail,tap2deb,tap2rpm,tapconvert,tasksel,taskset,tbl,tee,telnet,telnet.netkit,test,testparm,testparm.samba3,tfmtodit,tgatoppm,thinkjettopbm,tic,tifftopnm,time,tload,toe,top,touch,tput,tr,tracepath,tracepath6,traceroute6,traceroute6.iputils,traptoemail,tred,trial,troff,truncate,tset,tsort,tty,twistd,twopi,tzselect,ubuntu-bug,ubuntu-support-status,ucf,ucfq,ucfr,ucs2any,ul,unattended-upgrade,unattended-upgrades,unexpand,unflatten,unicode_stop,uniq,unlink,unlzma,unshare,unzip,unzipsfx,update-alternatives,updatedb,updatedb.mlocate,update-mime-database,update-mime-database.real,update-pciids,update-perl-sax-parsers,uptime,usb-devices,users,uuidgen,vi,view,vim,vim.basic,vimdiff,vim.tiny,vimtutor,vmstat,volname,w,w3m,w3mman,wall,watch,wbmptopbm,wc,webalizer,webazolver,wftopfa,wget,whatis,whereis,which,whiptail,who,whoami,winicontoppm,wpa_passphrase,w.procps,write,www-browser,X11,x86_64,x86_64-linux-gnu-cpp,x86_64-linux-gnu-cpp-4.4,xargs,xauth,xbmtopbm,ximtoppm,xpmtoppm,xsubpp,xtotroff,xvminitoppm,xwdtopnm,xxd,ybmtopbm,yes,yuvsplittoppm,yuvtoppm,zabbix_get,zdump,zeisstopnm,zipgrep,zipinfo,zsoelim,,/usr/sbin/:,a2dismod,a2dissite,a2enmod,a2ensite,aa-audit,aa-autodep,aa-complain,aa-decode,aa-enforce,aa-genprof,aa-logprof,aa-status,aa-unconfined,ab,accessdb,addgroup,add-shell,adduser,apache2,apache2ctl,apparmor_status,arp,arpd,atd,audit,autodep,bacula-console,bacula-fd,bandwidthd,bcrelay,biosdecode,brctl,bsmtp,btraceback,chat,check_forensic,checkgid,chgpasswd,chpasswd,chroot,ck-log-system-restart,ck-log-system-start,ck-log-system-stop,complain,console-kit-daemon,cpgr,cppw,cron,cytune,dbconfig-generate-include,dbconfig-load-include,defoma-reconfigure,delgroup,deluser,dmidecode,dpkg-divert,dpkg-preconfigure,dpkg-reconfigure,dpkg-statoverride,e2freefrag,enforce,ethtool,exicyclog,exigrep,exim,exim4,exim_checkaccess,exim_convert4r4,exim_dbmbuild,exim_dumpdb,exim_fixdb,exim_lock,eximstats,exim_tidydb,exinext,exipick,exiqgrep,exiqsumm,exiwhat,fancontrol,fdformat,filefrag,genprof,gmetad,gmond,gnokiid,groupadd,groupdel,groupmod,grpck,grpconv,grpunconv,grub-install,grub-mkconfig,grub-mkdevicemap,grub-probe,grub-reboot,grub-set-default,grub-setup,gss_clnt_send_err,gss_destroy_creds,htcacheclean,httxt2dbm,iconvconfig,install-info,install-sgmlcatalog,invoke-rc.d,ip6tables-apply,ipmievd,iptables-apply,irqbalance,isadump,isaset,laptop-detect,ldattach,libgraphviz4-config-update,locale-gen,login.radius,logprof,logresolve,logrotate,lsusb,make-ssl-cert,mgnokiidev,mkinitramfs,mkinitramfs-kpkg,mklost+found,munin-node,munin-node-configure,munin-run,mysqld,mysqlmanager,nagios3,nagios3stats,newusers,nfsstat,nologin,ntop,ntpd,ntpdate,ntpdate-debian,openntpd,openvpn,openvpn-vulnkey,ownership,pam-auth-update,pam_getenv,paperconfig,popcon-largest-unused,popularity-contest,pppconfig,pppd,pppdump,pppoeconf,pppoe-discovery,pppstats,pptpctrl,pptpd,pwck,pwconv,pwmconfig,pwunconv,radacct,radexample,radlogin,radstatus,ramsize,rdev,readprofile,remove-shell,rmail,rmt,rmt-dump,rmt-tar,rootflags,rotatelogs,rpcdebug,rpc.gssd,rpc.idmapd,rsmtp,rsyslogd,rtcwake,runq,safe_finger,sendmail,sensors-detect,service,setvesablank,snmpd,snmptrapd,spine,split-logfile,sshd,syslog2eximlog,tcpd,tcpdchk,tcpdmatch,tcpdump,try-from,tunelp,tzconfig,ufw,unconfined,update-alternatives,update-bootsystem-insserv,update-ca-certificates,update-catalog,update-exim4.conf,update-exim4.conf.template,update-exim4defaults,update-fonts-alias,update-fonts-dir,update-fonts-scale,update-gdkpixbuf-loaders,update-grub,update-grub2,update-gtk-immodules,update-icon-caches,update-inetd,update-info-dir,update-initramfs,update-locale,update-mime,update-pangox-aliases,update-passwd,update-python-modules,update-rc.d,update-rc.d-insserv,update-usbids,update-xmlcatalog,upgrade-from-grub-legacy,useradd,userdel,usermod,uuidd,validlocale,vcstime,vidmode,vigr,vipw,visudo,vpddecode,vsftpd,xl2tpd,zabbix_server,zic&#10;&#9;&#9;&#9;, CentOS, Piranha, NFS, &#10;&#9;&#9;&#9;&#9;arch,awk,basename,bash,cat,cgclassify,cgcreate,cgdelete,cgexec,cgget,cgset,chgrp,chmod,chown,cp,cpio,cut,dash,date,dd,df,dmesg,dnsdomainname,domainname,dumpkeys,echo,egrep,env,ex,false,fgrep,find,gawk,grep,gtar,gunzip,gzip,hostname,ipcalc,iptables-xml,kbd_mode,kill,link,ln,loadkeys,login,ls,lscgroup,lssubsys,mkdir,mknod,mktemp,more,mount,mountpoint,mv,mybash,netstat,nice,nisdomainname,ping,ping6,plymouth,ps,pwd,raw,readlink,rm,rmdir,rpm,rvi,rview,sed,setfont,sh,shell.sh,sleep,sort,stty,su,sync,tar,taskset,touch,tracepath,tracepath6,true,umount,uname,unicode_start,unicode_stop,unlink,usleep,vi,view,ypdomainname,zcat,,/sbin/:,addpart,agetty,arp,arping,audispd,auditctl,auditd,aureport,ausearch,autrace,badblocks,blkid,blockdev,cbq,cfdisk,cgclear,cgconfigparser,cgrulesengd,chkconfig,clock,consoletype,crda,ctrlaltdel,debugfs,delpart,depmod,dracut,dumpe2fs,e2fsck,e2image,e2label,e2undo,ether-wake,ethtool,fdisk,findfs,fixfiles,fsck,fsck.cramfs,fsck.ext2,fsck.ext3,fsck.ext4,fsck.ext4dev,fsfreeze,fstab-decode,fuser,genhostid,getkey,grub,grubby,grub-install,grub-md5-crypt,grub-terminfo,halt,hwclock,ifcfg,ifconfig,ifdown,ifenslave,ifrename,ifup,init,initctl,insmod,insmod.static,install-info,installkernel,ip,ip6tables,ip6tables-multi,ip6tables-restore,ip6tables-save,ipmaddr,iptables,iptables-multi,iptables-restore,iptables-save,iptunnel,iw,iwconfig,iwevent,iwgetid,iwlist,iwpriv,iwspy,killall5,ldconfig,load_policy,logsave,losetup,lsinitrd,lsmod,lspci,MAKEDEV,matchpathcon,mii-diag,mii-tool,mingetty,mke2fs,mkfs,mkfs.cramfs,mkfs.ext2,mkfs.ext3,mkfs.ext4,mkfs.ext4dev,mkhomedir_helper,mkinitrd,mkswap,modinfo,modprobe,mount.nfs,mount.nfs4,mount.tmpfs,nameif,netreport,new-kernel-pkg,nologin,pam_console_apply,pam_tally2,pam_timestamp_check,partx,pidof,pivot_root,plipconfig,plymouthd,poweroff,ppp-watch,rdisc,reboot,regdbdump,reload,resize2fs,restart,restorecon,rmmod,route,rpcbind,rpc.statd,rsyslogd,rtmon,runlevel,runuser,scsi_id,securetty,service,setfiles,setpci,setregdomain,setsysfont,sfdisk,shutdown,slattach,sln,start,start_udev,status,stop,sulogin,sushell,swapoff,swapon,switch_root,sysctl,tc,telinit,tune2fs,udevadm,udevd,umount.nfs,umount.nfs4,unix_chkpwd,unix_update,weak-modules,wipefs&#10;&#9;&#9;&#9;, &#10;&#9;&#9;&#9;&#9;a2p,ab,aclocal,aclocal-1.11,addftinfo,addr2line,airdaemon,apropos,ar,as,attr,aulast,aulastlog,ausyscall,autoconf,autoheader,autom4te,automake,automake-1.11,autoreconf,autoscan,autoupdate,awk,base64,bashbug-64,berkeley_db_svc,bunzip2,bzcat,bzcmp,bzdiff,bzgrep,bzip2,bzip2recover,bzless,bzmore,c++,c2ph,c89,c99,cal,captoinfo,catchsegv,cc,c++filt,chacl,chage,chattr,chcon,checkmodule,checkpolicy,chfn,chrt,chsh,chvt,cjpeg,cksum,clear,cloog,cmp,col,colcrt,colrm,column,comm,consolehelper,convertcfg,cpp,crontab,csplit,curl,curl-config,cut,cxpm,db_archive,db_checkpoint,db_codegen,db_deadlock,db_dump,db_dump185,db_hotbackup,db_load,db_printlog,db_recover,db_stat,db_upgrade,dbus-binding-tool,db_verify,ddate,deallocvt,diff,diff3,dir,dircolors,dirname,djpeg,dprofpp,du,env,eqn,eqn2graph,erb,ex,expand,expr,factor,faillog,fallocate,fc-cache,fc-cat,fc-list,fc-match,fc-query,fc-scan,fgconsole,file,filedaemon,find,find2perl,fipscheck,fipshmac,flock,floppy,fmt,fold,free,freetype-config,funzip,g++,gawk,gcc,gcov,gdlib-config,gem,gencat,geqn,getconf,getent,getfacl,getfattr,getkeycodes,getopt,gindxbib,glookbib,gmake,gneqn,gnroff,gpasswd,gpg,gpg2,gpg-agent,gpgconf,gpg-connect-agent,gpg-error,gpgkey2ssh,gpgparsemail,gpgsplit,gpgv,gpgv2,gpg-zip,gpic,gprof,grefer,grn,grodvi,groff,groffer,grog,grolbp,grolj4,grops,grotty,groups,gsoelim,gtbl,gtroff,gunzip,gzexe,gzip,h2ph,halt,head,hexdump,hostid,hpftodit,htdbm,htdigest,htpasswd,i386,iconv,id,idn,ifnames,igawk,indxbib,info,infocmp,infokey,infotocap,install,ionice,ipcmk,ipcrm,ipcs,ipmicmd,ipmilan,ipmish,ipmitool,ipmi_ui,irb,isosize,join,jpegtran,kbdrate,kill,killall,last,lastb,lastlog,lchfn,lchsh,ld,ldd,less,lessecho,lesskey,lesspipe.sh,libpng12-config,libpng-config,linux32,linux64,lkbib,loadunimap,locale,localedef,logger,logname,logresolve,look,lookbib,lsattr,lscpu,lua,luac,lzcat,lzcmp,lzdiff,lzegrep,lzfgrep,lzgrep,lzless,lzma,lzmadec,lzmainfo,lzmore,m4,mailq,mailq.postfix,make,man,man2html,manpath,mapscrn,mbchk,mcookie,md5sum,mesg,mini_epn,mkfifo,nagios,nagiostats,namei,neqn,net-snmp-create-v3-user,newaliases,newaliases.postfix,newgrp,new_mini_epn,nl,nm,nohup,nproc,nroff,ntpstat,objcopy,objdump,od,oldfind,open,openipmicmd,openipmish,openssl,openvt,p1.pl,passwd,paste,pathchk,pcregrep,pcretest,peekfd,perl,perl5.10.1,perlbug,perldoc,perlthanks,pfbtops,pgawk,pgrep,phar,phar.phar,php,php-cgi,pic,pic2graph,piconv,pinentry,pinentry-curses,pinky,pkg-config,pkill,pl2pm,plymouth,pmap,pod2html,pod2latex,pod2man,pod2text,pod2usage,podchecker,podselect,post-grohtml,poweroff,ppl-config,pr,pre-grohtml,printenv,printf,protoize,psed,psfaddtable,psfgettable,psfstriptable,psfxtable,pstree,pstree.x11,pstruct,ptx,pwdx,pydoc,python,python2,python2.6,ranlib,rb,rdjpgcom,rdoc,readelf,readlink,reboot,refer,rename,renice,reset,resizecons,rev,rhgb-client,ri,rmail,rmail.postfix,rmcp_ping,rpcgen,rpm2cpio,rpmdb,rpmquery,rpmsign,rpmverify,rsync,ruby,runcon,run-parts,rvim,rx,rz,s2p,sb,scp,script,scriptreplay,sdiff,secon,sedismod,sedispol,semodule_deps,semodule_expand,semodule_link,semodule_package,seq,sequel,setarch,setfacl,setfattr,setkeycodes,setleds,setmetamode,setsid,setterm,setup-nsssysinit.sh,sftp,sg,sha1sum,sha224sum,sha256sum,sha384sum,sha512sum,showconsolefont,showkey,shred,shuf,size,skill,slabtop,slogin,snice,snmpconf,snmpkey,soelim,solterm,splain,split,sprof,sqlite3,ssh,ssh-add,ssh-agent,ssh-copy-id,ssh-keygen,ssh-keyscan,stat,stdbuf,strings,strip,sudo,sudoedit,sum,sx,sxpm,system-config-network,system-config-network-cmd,sz,tabs,tac,tail,tailf,tbl,tee,telnet,test,testrb,tfmtodit,tic,time,timeout,tload,toe,top,tput,tr,troff,truncate,tset,tsort,tty,tzselect,ul,unexpand,uniq,unlzma,unprotoize,unshare,unxz,unzip,unzipsfx,uptime,urlgrabber,users,utmpdump,uuidgen,vdir,vim,vimdiff,vimtutor,vmstat,w,wall,watch,watchgnupg,wc,wget,whatis,whereis,which,whiptail,who,whoami,write,wrjpgcom,x86_64,x86_64-redhat-linux-c++,x86_64-redhat-linux-g++,x86_64-redhat-linux-gcc,xargs,xml2-config,xmlcatalog,xmllint,xmlwf,xxd,xz,xzcat,xzcmp,xzdec,xzdiff,xzegrep,xzfgrep,xzgrep,xzless,xzmore,yaf,yafcollect,yafscii,yes,yum,zcmp,zdiff,zegrep,zfgrep,zforce,zgrep,zip,zipcloak,zipgrep,zipinfo,zipnote,zipsplit,zless,zmore,znew,zsoelim,,/usr/sbin/:,addgnupghome,adduser,alternatives,anacron,apachectl,applygnupgdefaults,arpd,arping,authconfig,authconfig-tui,avcstat,build-locale-archive,cacertdir_rehash,capsh,chpasswd,chroot,clockdiff,cracklib-check,cracklib-format,cracklib-packer,cracklib-unpacker,create-cracklib-dict,crond,e2freefrag,efibootmgr,ethtool,exportfs,fdformat,filefrag,fping,fping6,genhomedircon,getcap,getenforce,getpcaps,getsebool,glibc_post_upgrade.x86_64,groupadd,groupdel,groupmems,groupmod,grpck,grpconv,grpunconv,gss_clnt_send_err,gss_destroy_creds,htcacheclean,httpd,httpd.event,httpd.worker,httxt2dbm,hwclock,iconvconfig,iconvconfig.x86_64,ipmievd,lchage,ldattach,lgroupadd,lgroupdel,lgroupmod,libgcc_post_upgrade,lid,lnewusers,lnstat,load_policy,logrotate,lokkit,lpasswd,lsof,luseradd,luserdel,lusermod,makewhatis,matchpathcon,mkdict,mklost+found,mksock,mountstats,newusers,nfsiostat,nfsstat,nrpe,nstat,ntpd,ntpdate,ntpdc,ntp-keygen,ntpq,ntptime,open_init_pty,packer,pethtool,pifconfig,ping6,pluginviewer,plymouth-set-default-theme,postalias,postcat,postconf,postdrop,postfix,postkick,postlock,postlog,postmap,postmulti,postqueue,postsuper,pwck,pwconv,pwunconv,readprofile,restorecond,rotatelogs,rpcdebug,rpc.gssd,rpc.idmapd,rpcinfo,rpc.mountd,rpc.nfsd,rpc.svcgssd,rtacct,rtcwake,run_init,saslauthd,sasldblistusers2,saslpasswd2,selinuxconlist,selinuxdefcon,selinuxenabled,semodule,sendmail,sendmail.postfix,sestatus,setcap,setenforce,setsebool,showmount,sm-notify,smtp-sink,smtp-source,snmpd,snmptrapd,ss,sshd,start-statd,suexec,system-config-network,system-config-network-cmd,system-config-network-tui,sys-unconfig,tcpdump,tcpslice,testsaslauthd,tickadj,togglesebool,tracepath,tracepath6,tunelp,tzdata-update,update-alternatives,update-pciids,useradd,userdel,userhelper,usermod,usernetctl,vigr,vipw,visudo,zdump,zic&#10;&#9;&#9;&#9;" /><link rel="home" href="../../index.html" title="Netkiller Linux 手札" /><link rel="up" href="index.html" title="第 11 章 Networking 网络管理" /><link rel="prev" href="wireless.html" title="11.9. Wireless - WiFi 配置" /><link rel="next" href="linux.network.old.html" title="11.11. 早期版本" /></head><body><a xmlns="" href="//www.netkiller.cn/">Home</a> |
		<a xmlns="" href="//netkiller.github.io/">简体中文</a> |
	    <a xmlns="" href="http://netkiller.sourceforge.net/">繁体中文</a> |
	    <a xmlns="" href="/journal/index.html">杂文</a> |
	    <a xmlns="" href="https://github.com/netkiller">Github</a> |
	    <a xmlns="" href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a> |
   	    <a xmlns="" href="https://edu.51cto.com/lecturer/1703915.html">51CTO学院</a> |
	    <a xmlns="" href="https://edu.csdn.net/lecturer/6423">CSDN程序员研修院</a> |
	    <a xmlns="" href="http://my.oschina.net/neochen/">OSChina 博客</a> |
	    <a xmlns="" href="https://cloud.tencent.com/developer/column/2078">腾讯云社区</a> |
	    <a xmlns="" href="https://yq.aliyun.com/u/netkiller/">阿里云栖社区</a> |
	    <a xmlns="" href="https://www.facebook.com/bg7nyt">Facebook</a> |
	    <a xmlns="" href="http://cn.linkedin.com/in/netkiller/">Linkedin</a> |
	    <a xmlns="" href="https://www.youtube.com/user/bg7nyt/videos">Youtube</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/donations.html">打赏(Donations)</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/about.html">About</a><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">11.10. Linux IP And Router</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="wireless.html">上一页</a> </td><th width="60%" align="center">第 11 章 Networking 网络管理</th><td width="20%" align="right"> <a accesskey="n" href="linux.network.old.html">下一页</a></td></tr></table><hr /></div><table xmlns=""><tr><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=watch&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=fork&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;type=follow&amp;count=true&amp;size=large" height="30" width="240" frameborder="0" scrolling="0" style="width:240px; height: 30px;" allowTransparency="true"></iframe></td><td></td><td><a href="https://zhuanlan.zhihu.com/netkiller"><img src="/images/logo/zhihu-card-default.svg" height="25" /></a></td><td valign="middle"><a href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a> ｜ <a href="https://www.zhihu.com/club/1241768772601950208">多维度架构</a></td><td></td><td></td><td></td><td></td></tr></table><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="router"></a>11.10. Linux IP And Router</h2></div></div></div>
	
	
	
	
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="network.ipaddress"></a>11.10.1. IP 地址类别</h3></div></div></div>
		
		<div class="literallayout"><p><br />
		<br />
举例说明该算法。<br />
例：给定一 class c address : 192.168.5.0 ，要求划分20个子网，每个子网5个主机。<br />
解：因为4 &lt;5 &lt; 8 ，用256－8＝248 ----&gt;即是所求的子网掩码，对应的子网数也就出来了。这是针对C类地址。<br />
针对B类地址的做法。对于B类地址，假如主机数小于或等于254，与C类地址算法相同。对于主机数大于254的，如需主机 700台，50个子网（相当大了），512 &lt; 700&lt; 1024<br />
256－（1024/256）=256－4＝252 ----&gt;即是所求的子网掩码，对应的子网数也就出来了。上面256－4中的4（2的2次幂）是指主机数用2进制表示时超过8位的位数，即超过2位，掩码为剩余的前6位，即子网数为2（6）－2＝62个。<br />
		<br />
		</p></div>
		<pre class="screen">
Append :Host/Subnet Quantities Table

----------------------------------------------------------------------
Class A                   Effective  Effective
# bits        Mask         Subnets     Hosts
-------  ---------------  ---------  ---------
  2      255.192.0.0            2      4194302
  3      255.224.0.0            6      2097150
  4      255.240.0.0           14      1048574
  5      255.248.0.0           30       524286
  6      255.252.0.0           62       262142
  7      255.254.0.0          126       131070
  8      255.255.0.0          254        65536
  9      255.255.128.0        510        32766
  10     255.255.192.0       1022        16382
  11     255.255.224.0       2046         8190
  12     255.255.240.0       4094         4094
  13     255.255.248.0       8190         2046
  14     255.255.252.0      16382         1022
  15     255.255.254.0      32766          510
  16     255.255.255.0      65536          254
  17     255.255.255.128   131070          126
  18     255.255.255.192   262142           62
  19     255.255.255.224   524286           30
  20     255.255.255.240  1048574           14
  21     255.255.255.248  2097150            6
  22     255.255.255.252  4194302            2

Class B                   Effective  Effective
# bits        Mask         Subnets     Hosts
-------  ---------------  ---------  ---------
  2      255.255.192.0           2     16382
  3      255.255.224.0           6      8190
  4      255.255.240.0          14      4094
  5      255.255.248.0          30      2046
  6      255.255.252.0          62      1022
  7      255.255.254.0         126       510
  8      255.255.255.0         254       254
  9      255.255.255.128       510       126
  10     255.255.255.192      1022        62
  11     255.255.255.224      2046        30
  12     255.255.255.240      4094        14
  13     255.255.255.248      8190         6
  14     255.255.255.252     16382         2

Class C                   Effective  Effective
# bits        Mask         Subnets     Hosts
-------  ---------------  ---------  ---------
  2      255.255.255.192      2         62
  3      255.255.255.224      6         30
  4      255.255.255.240     14         14
  5      255.255.255.248     30          6
  6      255.255.255.252     62          2

*Subnet all zeroes and all ones excluded.
*Host all zeroes and all ones excluded.
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="ping"></a>11.10.2. ping</h3></div></div></div>
		
		<pre class="screen">
			
-f: 发送洪水请求,每个请求打印一个点,每个响应删除一个点.如果网络存在丢包,那么会呈现出一长串不断增加的点.

-n: 选项,加上之后可以阻止ping程序去进行反向dns查询
    当每次ping完得到响应之后,ping程序会尝试一次反向dns查询(reverse dns lookup)来获取“64 bytes from”后面的域名,如果查询速度很慢的话,就会给人似乎延迟很大的感觉,其实这也是ping感觉慢,但是每次ping的响应时间却并不慢的原因.
			
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="mtu"></a>11.10.3. Finding optimal MTU</h3></div></div></div>
		
		<pre class="screen">
			
$ ping -c 1 -s $((1500-28)) -M do www.debian.org
PING www.debian.org (140.112.8.139) 1472(1500) bytes of data.
1480 bytes from linux3.cc.ntu.edu.tw (140.112.8.139): icmp_seq=1 ttl=47 time=52.7 ms

--- www.debian.org ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 52.778/52.778/52.778/0.000 ms
			
		</pre>
		<p>Try 1454 instead of 1500</p>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="ss"></a>11.10.4. ss - another utility to investigate sockets</h3></div></div></div>
		
		<pre class="screen">
			
ss是Socket Statistics的缩写
    ss命令可以用来获取socket统计信息,它可以显示和netstat类似的内容;但ss的优势在于它能够显示更多更详细的有关TCP和连接状态的信息,而且比netstat更快速更高效.
    
    当服务器的socket连接数量变得非常大时,无论是使用netstat命令还是直接cat /proc/net/tcp,执行速度都会很慢;ss快的秘诀在于,它利用到了TCP协议栈中 tcp_diag . tcp_diag是一个用于分析统计的模块, 用netfilter来获取第Linux内核中第一手的信息,这就确保了ss的快捷高效;如果你的系统中没有tcp_diag,ss也可以正常运行,只是效率会变得稍慢.
    
    netstat命令是net-tools工具集中的一员,而ss命令是iproute工具集中的一员.
    yum install iproute iproute-doc


#### ss过滤器

ss的过滤器分为两种:
     state
         状态:established,syn-sent,syn-recv,fin-wait-1,fin-wait-2,time-wait,closed,close-wait,last-ack,listen,closing
         除了这13种状态之外,还有几个聚类的状态:
             all – for all the states
             bucket – 显示状态为maintained as minisockets,如：time-wait和syn-recv
             big – 和bucket相反
             connected – 除了listen and closed的所有状态
             synchronized – 所有已连接的状态除了syn-sent
     addr+port
         地址和端口可以使用表达式,类似于tcpdump中的用法,关键字有:
             dst ADDRESS_PATTERN – matches remote address and port
             src ADDRESS_PATTERN – matches local address and port
             dport RELOP PORT – compares remote port to a number
             sport RELOP PORT – compares local port to a number
             autobound – checks that socket is bound to an ephemeral port

#### ss usage

ss [ OPTIONS ] [ FILTER ]
        OPTIONS:
            -p 显示每个进程的名字和pid
            -s 列出当前socket详细信息
            -n 不解析服务名称
            -r 解析主机名
            -a 显示所有套接字(sockets)
            -o 显示计时器信息(timer)
            -l 显示监听状态的套接字(sockets)
            -e 显示详细的套接字(sockets)信息
            -m 显示套接字(sockets)的内存使用情况
            -i 显示 TCP内部信息
            -4 仅显示IPv4的套接字(sockets)
            -6 仅显示IPv6的套接字(sockets)
            -0 显示 PACKET 套接字(sockets)
            -t 仅显示 TCP套接字(sockets)
            -u 仅显示 UCP套接字(sockets)
            -d 仅显示 DCCP套接字(sockets)
            -w 仅显示 RAW套接字(sockets)
            -x 仅显示 Unix套接字(sockets)
            -f --family=FAMILY  显示 FAMILY类型的套接字(sockets),FAMILY可选,支持 unix, inet, inet6, link, netlink
            -D --diag=FILE     将原始TCP套接字(sockets)信息转储到文件
            -F --filter=FILE   从文件中都去过滤器信息 FILTER := [ state TCP-STATE ] [ EXPRESSION ]

#### Recv And Send

[root@netkiller ~]# ss -anp | column -c1
State      Recv-Q Send-Q        Local Address:Port          Peer Address:Port
LISTEN     0      128               127.0.0.1:9000                     *:*      users:(("php-fpm",1481,9),("php-fpm",1482,0),("php-fpm",1483,0),("php-fpm",1484,0),("php-fpm",1485,0),("php-fpm",1486,0),("php-fpm",1487,0),("php-fpm",1488,0),("php-fpm",1489,0),("php-fpm",1490,0),("php-fpm",1491,0))
LISTEN     0      50                        *:3306                     *:*      users:(("mysqld",2680,11))
LISTEN     0      128                       *:443                      *:*      users:(("nginx",1743,8),("nginx",1744,8),("nginx",1745,8))
LISTEN     0      128              10.1.17.17:2812                     *:*      users:(("monit",2030,6))
TIME-WAIT  0      0                 127.0.0.1:43251            127.0.0.1:80
TIME-WAIT  0      0                 127.0.0.1:43248            127.0.0.1:80
ESTAB      0      0                10.1.17.17:22              10.1.17.18:51752  users:(("sshd",3122,3))
ESTAB      0      0                10.1.17.17:22              10.1.20.70:51531  users:(("sshd",19093,3))

处于LISTEN状态的socket:
    Recv-Q表示了current listen backlog队列元素数目(等待用户调用accept的完成3次握手的socket)
    Send-Q表示了listen socket最大能容纳的backlog.这个数目由listen时指定,且不能大于 /proc/sys/net/ipv4/tcp_max_syn_backlog;
    
对于非LISTEN socket:
    Recv-Q表示了receive queue中的字节数目(等待接收的下一个tcp段的序号-尚未从内核空间copy到用户空间的段最前面的一个序号)
    Send-Q表示发送queue中容纳的字节数(已加入发送队列中最后一个序号-输出段中最早一个未确认的序号)


#### Sockets State
&gt;1 Listen


[root@netkiller ~]# ss -lnp | column -c1
State      Recv-Q Send-Q        Local Address:Port          Peer Address:Port
LISTEN     0      128               127.0.0.1:9000                     *:*      users:(("php-fpm",1481,9),("php-fpm",1482,0),("php-fpm",1483,0),("php-fpm",1484,0),("php-fpm",1485,0),("php-fpm",1486,0),("php-fpm",1487,0),("php-fpm",1488,0),("php-fpm",1489,0),("php-fpm",1490,0),("php-fpm",1491,0))
LISTEN     0      50                        *:3306                     *:*      users:(("mysqld",2680,11))
LISTEN     0      50                        *:3307                     *:*      users:(("mysqld",2564,11))

&gt;2 Established


[root@netkiller ~]# ss -onp state established | column -c1
Recv-Q Send-Q             Local Address:Port               Peer Address:Port
0      0                     10.1.17.17:22                   10.1.17.18:51752  timer:(keepalive,70min,0) users:(("sshd",3122,3))
0      0                     10.1.17.17:22                   10.1.20.70:51531  timer:(keepalive,69min,0) users:(("sshd",19093,3))

&gt;3 Sockets Summary


[root@netkiller ~]# ss -s
Total: 93 (kernel 150)
TCP:   106 (estab 10, closed 88, orphaned 0, synrecv 0, timewait 88/0), ports 41

Transport Total     IP        IPv6
*	  150       -         -
RAW	  0         0         0
UDP	  1         1         0
TCP	  18        18        0
INET	  19        19        0
FRAG	  0         0         0

&gt;4 Expand


1 显示所有状态为established的ssh连接
[root@netkiller ~]# ss -o state established '( dport = :ssh or sport = :ssh )'
Recv-Q Send-Q                                      Local Address:Port                                          Peer Address:Port
0      0                                              10.1.17.17:ssh                                             10.1.17.18:51752    timer:(keepalive,109min,0)
0      0                                              10.1.17.17:ssh                                             10.1.20.70:51531    timer:(keepalive,103min,0)

#### ***timer user mem rto*** 

------在另外一个终端执行 ssh 10.1.2.103-----
然后在本终端执行如下命令
[root@netkiller ~]# ss -eimpn '( dport = :22 )' -o
State      Recv-Q Send-Q                                                          Local Address:Port                                                            Peer Address:Port
ESTAB      0      0                                                                   10.1.2.23:44107                                                             10.1.2.103:22     timer:(keepalive,28min,0) users:(("ssh",9545,4)) ino:21970248 sk:ffff88013c2e5900
	 mem:(r0,w0,f4096,t0) sack cubic wscale:7,8 rto:203 rtt:3.25/1.75 ato:40 cwnd:10 send 35.9Mbps rcv_rtt:33427 rcv_space:113592
	 
------在另外一个终端执行 telnet 27.111.200.86 15672-----
然后在本终端执行如下命令
[root@netkiller ~]# ss -eimpn '( dport = :15672 )' -o
State      Recv-Q Send-Q                                                          Local Address:Port                                                            Peer Address:Port
ESTAB      0      2                                                                   10.1.2.23:57531                                                          27.111.200.86:15672  timer:(on,614ms,0) users:(("telnet",10163,4)) ino:21983807 sk:ffff8800378ba040
	 mem:(r0,w554,f3542,t0) sack cubic wscale:7,8 cwnd:10 rcv_space:14600

&gt; timer


-o 显示计时器信息(timer),linux对一个tcp socket总共有7个定时器,通过4个timer实现
    通过icsk_retransmit_timer实现的重传定时器,零窗口探测定时器;
    通过sk_timer实现的连接建立定时器,保活定时器和FIN_WAIT_2定时器;
    通过icsk_delack_timer实现的延时ack定时器以及TIME_WAIT定时器.
    
timer 这个输出描述的是tcp socket上的定时器
timer 的输出含义就是(类型,过期时间,重试次数)
    off: 当前socket没有timer
    on: 重传timer
    keepalive：连接建立timer or fin_wait_2 timer or 保活timer;具体是那个timer,可以根据连接的状态来确定.
    timewait: TIME_WAITtimer
    persist：零窗口探测timer 

&gt; user


ss -p 输出users项里会出现三个参数:
    第一个是进程名
    第二个为pid
    第三项该进程文件描述符的使用数量

&gt; mem


mem:(r0,w554,f3542,t0)
r  the read (inbound) buffer
w  the write (outbound) buffer
f  the "forward allocated memory" (memory available to the socket)
t  the transmit queue (stuff waiting to be sent or waiting on an ACK)

&gt; socket information


sack cubic wscale
rto
rtt
cwnd
send
rcv_space

#### Notice
&gt;1 ss process name and pid


only name

ss -tp | grep -v Recv-Q | sed -e 's/.*users:(("//' -e 's/".*$//' | sort | uniq

only  pid
[root@netkiller ~]# ss -tp | grep -v Recv-Q | sed -e 's/.*users:((.*",//' -e 's/,.*$//'  | sort | uniq

name  and pid
# ss -tp | grep -v Recv-Q | sed -e 's/.*users:(("\(.*\)",\(.*\),.*$/\1:\2/' | sort | uniq
f_e_related_dat:4695
mysqld:4289
salt-minion:4001
sshd:25161
		
			
		</pre>
	</div>

	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="netmask"></a>11.10.5. netmask 子网掩码</h3></div></div></div>
		
		<p>
		
子网掩码快速算法
大家都应该知道2的x次方值吧？下面是2的0次到10次方的计算值分别是：
1 2 4 8 16 32 64 128 256 512 1024。
实例
如果你希望每个子网中只有5个ip地址可以给机器用，那么你就最少需要准备给每个子网7个ip位址，因为需要加上两头的不可用的网络和广播ip，所以你需要选比7多的最近的那位，也就是8，就是说选每个子网8个ip。到这一步，你就可以算屏蔽了。

这个方法就是：最后一位屏蔽就是256减去你每个子网所需要的ip位元址的数量，那么这个例子就是256-8=248，那么算出这个，你就可以知道那些ip是不能用的了，
依此类推：0-7,8-15,16-23,24-31，……，写在上面的0、7、8、15、16、23、24、31……都是不能用的，你应该用某两个数字之间的IP，那个就是一个子网可用的IP。

再试验一下，就拿200台机器分成4个子网来做例子吧。
200台机器，4个子网，那么就是每个子网50台机器，设定为192.168.10.0，C类的IP，大子网掩码应为255.255.255.0，对吧，但是我们要分子网，所以按照上面的，我们用32个IP一个子网内不够，应该每个子网用64个IP（其中62位可用，足够了吧），然后用我的办法：子网掩码应该是256-64=192，那么总的子网掩码应该为：255.255.255.192。不相信？算算：0-63，64-127，128-191，192-255，这样你就可以把四个区域分别设定到四个子网的机器上了。
		
		</p>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="iptab"></a>11.10.5.1. iptab</h4></div></div></div>
			
			<pre class="screen">
# iptab
+----------------------------------------------+
| addrs bits pref class mask |
+----------------------------------------------+
| 1 0 /32 255.255.255.255 |
| 2 1 /31 255.255.255.254 |
| 4 2 /30 255.255.255.252 |
| 8 3 /29 255.255.255.248 |
| 16 4 /28 255.255.255.240 |
| 32 5 /27 255.255.255.224 |
| 64 6 /26 255.255.255.192 |
| 128 7 /25 255.255.255.128 |
| 256 8 /24 1C 255.255.255.0 |
| 512 9 /23 2C 255.255.254.0 |
| 1K 10 /22 4C 255.255.252.0 |
| 2K 11 /21 8C 255.255.248.0 |
| 4K 12 /20 16C
255.255.240.0 |
| 8K 13 /19 32C 255.255.224.0 |
| 16K 14 /18 64C 255.255.192.0 |
| 32K 15 /17 128C 255.255.128.0 |
| 64K 16 /16 1B 255.255.0.0 |
| 128K 17 /15 2B 255.254.0.0 |
| 256K 18 /14 4B 255.252.0.0 |
| 512K 19 /13 8B 255.248.0.0 |
| 1M 20 /12 16B 255.240.0.0 |
| 2M 21 /11 32B 255.224.0.0 |
| 4M 22 /10 64B 255.192.0.0 |
| 8M 23 /9 128B 255.128.0.0 |
| 16M 24 /8 1A 255.0.0.0 |
| 32M 25 /7 2A 254.0.0.0 |
| 64M 26 /6 4A 252.0.0.0 |
| 128M 27 /5 8A 248.0.0.0 |
| 256M 28 /4 16A 240.0.0.0 |
| 512M 29 /3 32A 224.0.0.0 |
| 1024M 30 /2 64A 192.0.0.0 |
| 2048M 31 /1 128A 128.0.0.0 |
| 4096M 32 /0 256A 0.0.0.0 |
+----------------------------------------------+
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="netmask"></a>11.10.5.2. netmask - a netmask generation and conversion program</h4></div></div></div>
			
			<pre class="screen">
				$ sudo apt-get install netmask
			</pre>
			<p>-s, --standard Output address/netmask pairs</p>
			<pre class="screen">
$ netmask -s 192.168.1.0/28
192.168.1.0/255.255.255.240

$ netmask -s 192.168.1.0/24
192.168.1.0/255.255.255.0

$ netmask -s 192.168.1.0/24
192.168.1.0/255.255.255.0

$ netmask -s 192.168.1.0/26
192.168.1.0/255.255.255.192

[root@netkiller src]# netmask -s 11.111.195.211/27
11.111.195.192/255.255.255.224
			</pre>
			<p>-c, --cidr Output CIDR format address lists</p>
			<pre class="screen">
$ netmask -c 192.168.1.0/255.255.255.252
192.168.1.0/30

$ netmask -c 192.168.1.0/255.255.255.192
192.168.1.0/26

$ netmask -c 192.168.1.0/255.255.255.240
192.168.1.0/28
			</pre>
			<p>-i, --cisco Output Cisco style address lists 思科风格的反子网掩码计算</p>
			<pre class="screen">
$ netmask -i 192.168.1.0/255.255.255.0
192.168.1.0 0.0.0.255

$ netmask -i 192.168.1.0/255.255.255.252
192.168.1.0 0.0.0.3

$ netmask -i 192.168.1.0/24
192.168.1.0 0.0.0.255

$ netmask -i 192.168.1.0/28
192.168.1.0 0.0.0.15
			</pre>
			<p>-r, --range Output ip address ranges 输出地址范围</p>
			<p>计算子网掩码位数</p>
			<pre class="screen">
				[root@netkiller src]# netmask 11.111.195.211/255.255.255.224
				11.111.195.192/27
			</pre>
			<pre class="screen">
$ netmask -r 192.168.1.0/255.255.255.0
192.168.1.0-192.168.1.255 (256)

$ netmask -r 192.168.1.0/255.255.255.192
192.168.1.0-192.168.1.63 (64)

$ netmask -r 192.168.1.0/255.255.255.252
192.168.1.0-192.168.1.3 (4)

$ netmask -r 192.168.1.0/28
192.168.1.0-192.168.1.15 (16)

$ netmask -r 192.168.1.0/24
192.168.1.0-192.168.1.255 (256)
			</pre>
			<p></p>
			<pre class="screen">
$ netmask -r 192.168.1.0/255.255.255.252
192.168.1.0-192.168.1.3 (4)

$ netmask -r 192.168.1.2/255.255.255.252
192.168.1.0-192.168.1.3 (4)

$ netmask -r 192.168.1.6/255.255.255.252
192.168.1.4-192.168.1.7 (4)

$ netmask -r 192.168.1.12/255.255.255.252
192.168.1.12-192.168.1.15 (4)

$ netmask -r 192.168.1.13/255.255.255.252
192.168.1.12-192.168.1.15 (4)

$ netmask -r 192.168.1.100/255.255.255.252
192.168.1.100-192.168.1.103 (4)

$ netmask -r 192.168.1.100/255.255.255.240
192.168.1.96-192.168.1.111 (16)

$ netmask -r
192.168.1.50/255.255.255.240
192.168.1.48-192.168.1.63 (16)
			</pre>
			<p>-b, --binary Output address/netmask pairs in binary 二进制</p>
			<pre class="screen">
$ netmask -b 192.168.1.0/255.255.255.240
11000000 10101000 00000001 00000000 / 11111111 11111111 11111111 11110000

$ netmask -b 172.16.0.0/255.255.252.0
10101100 00010000 00000000 00000000 / 11111111 11111111 11111100 00000000
			</pre>
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="arp"></a>11.10.6. arp - manipulate the system ARP cache</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155721712"></a>11.10.6.1. display hosts</h4></div></div></div>
			
			<p>display (all) hosts in alternative (BSD) style</p>
			<pre class="screen">
				[root@dev2 ~]# arp -a
				? (192.168.3.253) at 00:1D:0F:82:05:DC [ether] on eth0
				? (192.168.3.48) at 00:25:64:9A:D7:CC [ether] on eth0
				? (192.168.3.101) at 00:25:64:A3:65:93 [ether] on eth0
				nis.example.com (192.168.3.5) at 00:25:64:9A:D7:E0 [ether] on eth0
				? (192.168.3.1) at 00:0F:E2:71:8E:FB [ether] on eth0
				? (192.168.3.153) at B8:AC:6F:25:D2:2E [ether] on eth0
			</pre>
			<p>display (all) hosts in default (Linux) style</p>
			<pre class="screen">
				[root@dev2 ~]# arp -e
				Address HWtype HWaddress Flags Mask Iface
				192.168.3.48 ether 00:25:64:9A:D7:CC C eth0
				192.168.3.101 ether 00:25:64:A3:65:93 C eth0
				nis.example.com ether 00:25:64:9A:D7:E0 C eth0
				192.168.3.1 ether 00:0F:E2:71:8E:FB C eth0
				10.0.0.1 ether 00:1F:12:55:A9:02 C eth0
				192.168.3.153 ether B8:AC:6F:25:D2:2E C eth0
			</pre>
			<p>don't resolve names</p>
			<pre class="screen">
				[root@dev2 ~]# arp -a -n
				? (192.168.3.253) at 00:1D:0F:82:05:DC [ether] on eth0
				? (192.168.3.48) at 00:25:64:9A:D7:CC [ether] on eth0
				? (192.168.3.101) at 00:25:64:A3:65:93 [ether] on eth0
				? (192.168.3.5) at 00:25:64:9A:D7:E0 [ether] on eth0
				? (192.168.3.1) at 00:0F:E2:71:8E:FB [ether] on eth0
				? (192.168.3.153) at B8:AC:6F:25:D2:2E [ether] on eth0
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155720656"></a>11.10.6.2. delete a specified entry</h4></div></div></div>
			
			<pre class="screen">
				[root@dev2 ~]# arp -d 192.168.3.101
				[root@dev2 ~]# arp -i eth1 -d 10.0.0.1
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155715072"></a>11.10.6.3. /proc/net/arp</h4></div></div></div>
			
			<pre class="screen">
				[root@dev2 ~]# cat /proc/net/arp
				IP address HW type Flags HW address Mask Device
				192.168.3.48 0x1 0x2 00:25:64:9A:D7:CC * eth0
				192.168.3.101 0x1 0x2 00:1E:7A:E0:47:40 * eth0
				192.168.3.5 0x1 0x2 00:25:64:9A:D7:E0 * eth0
				192.168.3.1 0x1 0x2 00:0F:E2:71:8E:FB * eth0
				192.168.3.153 0x1 0x2 B8:AC:6F:25:D2:2E * eth0
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155713360"></a>11.10.6.4. /etc/ethers</h4></div></div></div>
			
			<pre class="screen">
				# Ethernet-address IP-number
				00:25:64:9A:D7:CC 192.168.3.48
			</pre>
			<p>read new entries from file or from /etc/ethers</p>
			<pre class="screen">
				# arp -f
			</pre>
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="iproute2"></a>11.10.7. iproute2</h3></div></div></div>
		
		<pre class="screen">
			add 增加路由
			del 删除路由
			via 网关出口 IP地址
			dev 网关出口 物理设备名
		</pre>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155709488"></a>11.10.7.1. 查看帮助信息</h4></div></div></div>
			
			<pre class="screen">
			
[root@gitlab ~]# ip route replace help
Usage: ip route { list | flush } SELECTOR
       ip route save SELECTOR
       ip route restore
       ip route showdump
       ip route get [ ROUTE_GET_FLAGS ] ADDRESS
                            [ from ADDRESS iif STRING ]
                            [ oif STRING ] [ tos TOS ]
                            [ mark NUMBER ] [ vrf NAME ]
                            [ uid NUMBER ] [ ipproto PROTOCOL ]
                            [ sport NUMBER ] [ dport NUMBER ]
       ip route { add | del | change | append | replace } ROUTE
SELECTOR := [ root PREFIX ] [ match PREFIX ] [ exact PREFIX ]
            [ table TABLE_ID ] [ vrf NAME ] [ proto RTPROTO ]
            [ type TYPE ] [ scope SCOPE ]
ROUTE := NODE_SPEC [ INFO_SPEC ]
NODE_SPEC := [ TYPE ] PREFIX [ tos TOS ]
             [ table TABLE_ID ] [ proto RTPROTO ]
             [ scope SCOPE ] [ metric METRIC ]
             [ ttl-propagate { enabled | disabled } ]
INFO_SPEC := { NH | nhid ID } OPTIONS FLAGS [ nexthop NH ]...
NH := [ encap ENCAPTYPE ENCAPHDR ] [ via [ FAMILY ] ADDRESS ]
	    [ dev STRING ] [ weight NUMBER ] NHFLAGS
FAMILY := [ inet | inet6 | mpls | bridge | link ]
OPTIONS := FLAGS [ mtu NUMBER ] [ advmss NUMBER ] [ as [ to ] ADDRESS ]
           [ rtt TIME ] [ rttvar TIME ] [ reordering NUMBER ]
           [ window NUMBER ] [ cwnd NUMBER ] [ initcwnd NUMBER ]
           [ ssthresh NUMBER ] [ realms REALM ] [ src ADDRESS ]
           [ rto_min TIME ] [ hoplimit NUMBER ] [ initrwnd NUMBER ]
           [ features FEATURES ] [ quickack BOOL ] [ congctl NAME ]
           [ pref PREF ] [ expires TIME ] [ fastopen_no_cookie BOOL ]
TYPE := { unicast | local | broadcast | multicast | throw |
          unreachable | prohibit | blackhole | nat }
TABLE_ID := [ local | main | default | all | NUMBER ]
SCOPE := [ host | link | global | NUMBER ]
NHFLAGS := [ onlink | pervasive ]
RTPROTO := [ kernel | boot | static | NUMBER ]
PREF := [ low | medium | high ]
TIME := NUMBER[s|ms]
BOOL := [1|0]
FEATURES := ecn
ENCAPTYPE := [ mpls | ip | ip6 | seg6 | seg6local | rpl ]
ENCAPHDR := [ MPLSLABEL | SEG6HDR ]
SEG6HDR := [ mode SEGMODE ] segs ADDR1,ADDRi,ADDRn [hmac HMACKEYID] [cleanup]
SEGMODE := [ encap | inline ]
ROUTE_GET_FLAGS := [ fibmatch ]
			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155708208"></a>11.10.7.2. 启用/禁用 网络接口</h4></div></div></div>
			
			<pre class="screen">
			&lt;![CDATA[
sudo ip link set eth0 down
sudo ip link set eth0 up			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155706816"></a>11.10.7.3. 查看状态</h4></div></div></div>
			
			<pre class="screen">
			
[root@localhost ~]# ip link show
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: enp2s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq state UP mode DEFAULT group default qlen 1000
    link/ether 00:e0:70:81:a0:f5 brd ff:ff:ff:ff:ff:ff
3: wlp1s0: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
    link/ether 40:9f:38:b6:e0:31 brd ff:ff:ff:ff:ff:ff
4: br-0e0f0a52c09e: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noqueue state DOWN mode DEFAULT group default 
    link/ether 02:42:c4:61:cb:51 brd ff:ff:ff:ff:ff:ff
5: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN mode DEFAULT group default 
    link/ether 02:42:8b:b0:1d:c1 brd ff:ff:ff:ff:ff:ff
16578: br-ad3d9e94154d: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP mode DEFAULT group default 
    link/ether 02:42:5a:e6:15:f8 brd ff:ff:ff:ff:ff:ff
16582: vethb1a595b@if16581: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master br-ad3d9e94154d state UP mode DEFAULT group default 
    link/ether 2a:cb:a5:0e:ff:58 brd ff:ff:ff:ff:ff:ff link-netnsid 0			
			
			</pre>
			<p> -s, -stats, -statistics
				Output more information. If the option appears twice or more, the amount of information increases. As a rule, the information is statistics or some time values.
			</p>
			<pre class="screen">
			
[root@localhost ~]# ip -s link show
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    RX: bytes  packets  errors  dropped missed  mcast   
    524494906  58478    0       0       0       0       
    TX: bytes  packets  errors  dropped carrier collsns 
    524494906  58478    0       0       0       0       
2: enp2s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq state UP mode DEFAULT group default qlen 1000
    link/ether 00:e0:70:81:a0:f5 brd ff:ff:ff:ff:ff:ff
    RX: bytes  packets  errors  dropped missed  mcast   
    1650138393 3456155  0       1419    0       369     
    TX: bytes  packets  errors  dropped carrier collsns 
    631678091  1615937  0       0       0       0       
3: wlp1s0: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000
    link/ether 40:9f:38:b6:e0:31 brd ff:ff:ff:ff:ff:ff
    RX: bytes  packets  errors  dropped missed  mcast   
    0          0        0       0       0       0       
    TX: bytes  packets  errors  dropped carrier collsns 
    0          0        0       0       0       0       
4: br-0e0f0a52c09e: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noqueue state DOWN mode DEFAULT group default 
    link/ether 02:42:c4:61:cb:51 brd ff:ff:ff:ff:ff:ff
    RX: bytes  packets  errors  dropped missed  mcast   
    0          0        0       0       0       0       
    TX: bytes  packets  errors  dropped carrier collsns 
    10148      114      0       0       0       0       
5: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN mode DEFAULT group default 
    link/ether 02:42:8b:b0:1d:c1 brd ff:ff:ff:ff:ff:ff
    RX: bytes  packets  errors  dropped missed  mcast   
    560        20       0       0       0       0       
    TX: bytes  packets  errors  dropped carrier collsns 
    0          0        0       0       0       0       
16578: br-ad3d9e94154d: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP mode DEFAULT group default 
    link/ether 02:42:5a:e6:15:f8 brd ff:ff:ff:ff:ff:ff
    RX: bytes  packets  errors  dropped missed  mcast   
    4026856    31020    0       0       0       0       
    TX: bytes  packets  errors  dropped carrier collsns 
    534479810  41161    0       0       0       0       
16582: vethb1a595b@if16581: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master br-ad3d9e94154d state UP mode DEFAULT group default 
    link/ether 2a:cb:a5:0e:ff:58 brd ff:ff:ff:ff:ff:ff link-netnsid 0
    RX: bytes  packets  errors  dropped missed  mcast   
    4461136    31020    0       0       0       0       
    TX: bytes  packets  errors  dropped carrier collsns 
    534480956  41176    0       0       0       0   			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155704608"></a>11.10.7.4. 查看 IP 地址</h4></div></div></div>
			
			<p>查看所有IP地址</p>
			<pre class="screen">
			
[root@localhost ~]# ip addr show enp2s0
2: enp2s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq state UP group default qlen 1000
    link/ether 00:e0:70:81:a0:f5 brd ff:ff:ff:ff:ff:ff
    inet 192.168.30.13/24 brd 192.168.30.255 scope global noprefixroute enp2s0
       valid_lft forever preferred_lft forever
[root@localhost ~]# ip addr show
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: enp2s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq state UP group default qlen 1000
    link/ether 00:e0:70:81:a0:f5 brd ff:ff:ff:ff:ff:ff
    inet 192.168.30.13/24 brd 192.168.30.255 scope global noprefixroute enp2s0
       valid_lft forever preferred_lft forever
3: wlp1s0: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000
    link/ether 40:9f:38:b6:e0:31 brd ff:ff:ff:ff:ff:ff
4: br-0e0f0a52c09e: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noqueue state DOWN group default 
    link/ether 02:42:c4:61:cb:51 brd ff:ff:ff:ff:ff:ff
5: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default 
    link/ether 02:42:8b:b0:1d:c1 brd ff:ff:ff:ff:ff:ff
16578: br-ad3d9e94154d: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default 
    link/ether 02:42:5a:e6:15:f8 brd ff:ff:ff:ff:ff:ff
    inet 192.168.49.1/24 brd 192.168.49.255 scope global br-ad3d9e94154d
       valid_lft forever preferred_lft forever
    inet6 fe80::42:5aff:fee6:15f8/64 scope link 
       valid_lft forever preferred_lft forever
16582: vethb1a595b@if16581: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master br-ad3d9e94154d state UP group default 
    link/ether 2a:cb:a5:0e:ff:58 brd ff:ff:ff:ff:ff:ff link-netnsid 0
    inet6 fe80::28cb:a5ff:fe0e:ff58/64 scope link 
       valid_lft forever preferred_lft forever			
			
			</pre>
			<p>显示活动状态的IP地址</p>
			<pre class="screen">
			
[root@localhost ~]# ip addr show up
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: enp2s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq state UP group default qlen 1000
    link/ether 00:e0:70:81:a0:f5 brd ff:ff:ff:ff:ff:ff
    inet 192.168.30.13/24 brd 192.168.30.255 scope global noprefixroute enp2s0
       valid_lft forever preferred_lft forever
5: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default 
    link/ether 02:42:8b:b0:1d:c1 brd ff:ff:ff:ff:ff:ff
16578: br-ad3d9e94154d: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default 
    link/ether 02:42:5a:e6:15:f8 brd ff:ff:ff:ff:ff:ff
    inet 192.168.49.1/24 brd 192.168.49.255 scope global br-ad3d9e94154d
       valid_lft forever preferred_lft forever
    inet6 fe80::42:5aff:fee6:15f8/64 scope link 
       valid_lft forever preferred_lft forever			
			
			</pre>
			<p>查看指定接口的IP地址</p>
			<pre class="screen">
			
[root@localhost ~]# ip addr show enp2s0
2: enp2s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq state UP group default qlen 1000
    link/ether 00:e0:70:81:a0:f5 brd ff:ff:ff:ff:ff:ff
    inet 192.168.30.13/24 brd 192.168.30.255 scope global noprefixroute enp2s0
       valid_lft forever preferred_lft forever			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155700944"></a>11.10.7.5. 查看路由表</h4></div></div></div>
			
			<pre class="screen">
			
[root@localhost ~]# ip route list
default via 192.168.30.1 dev enp2s0 proto static metric 100 
192.168.30.0/24 dev enp2s0 proto kernel scope link src 192.168.30.13 metric 100 
192.168.49.0/24 dev br-ad3d9e94154d proto kernel scope link src 192.168.49.1 
192.168.49.2 via 192.168.49.1 dev br-ad3d9e94154d 			
			
			</pre>
			<pre class="screen">
			
[root@localhost ~]# ip route get default
local 0.0.0.0 dev lo src 127.0.0.1 uid 0 
    cache &lt;local&gt; 
[root@localhost ~]# ip route get 192.168.49.2
192.168.49.2 dev br-ad3d9e94154d src 192.168.49.1 uid 0 
    cache 			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155698752"></a>11.10.7.6. 添加路由</h4></div></div></div>
			
			<p>主机路由</p>
			<pre class="screen">
			
[root@gitlab ~]# ip route add 192.168.49.1 via 192.168.30.13 dev enp2s0
			
			</pre>
			<p>网络路由，指定吓一跳IP地址</p>
			<pre class="screen">	
[root@gitlab ~]# ip route add 192.168.0.0/24 via 192.168.0.1
			</pre>
			<p>指定出口接口</p>
			<pre class="screen">
			
[root@gitlab ~]# ip route add 192.168.49.0/24 dev enp2s0			
			
			</pre>
			<pre class="screen">
			
[root@gitlab ~]# ip route add 192.168.49.0/24 via 192.168.30.13 dev enp2s0			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155694752"></a>11.10.7.7. 删除路由</h4></div></div></div>
			
			<pre class="screen">
ip route del 192.168.0.0/24 via 192.168.0.1
			</pre>
			<p></p>
			<pre class="screen">
			
ip route del 192.168.49.0/24 via 192.168.30.5 dev enp2s0			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155692560"></a>11.10.7.8. 变更路由</h4></div></div></div>
			
			<pre class="screen">
[root@router ~]# ip route
192.168.5.0/24 dev eth0 proto kernel scope link src 192.168.5.47
192.168.3.0/24 dev eth0 proto kernel scope link src 192.168.3.47
default via 192.168.3.1 dev eth0

[root@router ~]# ip route change default via 192.168.5.1 dev eth0

[root@router ~]# ip route list
192.168.5.0/24 dev eth0 proto kernel scope link src 192.168.5.47
192.168.3.0/24 dev eth0 proto kernel scope link src 192.168.3.47
default via 192.168.5.1 dev eth0
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155690864"></a>11.10.7.9. 替换已有的路由</h4></div></div></div>
			
			<pre class="screen">
ip route replace
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155689648"></a>11.10.7.10. 增加默认路由</h4></div></div></div>
			
			<p>192.168.0.1 是我的默认路由器</p>
			<pre class="screen">
ip route add default via 192.168.0.1 dev eth0
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155687888"></a>11.10.7.11. cache</h4></div></div></div>
			
			<pre class="screen">
ip route flush cache
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155686624"></a>11.10.7.12. 只查看 ipv4 地址</h4></div></div></div>
			
			<pre class="screen">
			
[root@development ~]# ip -4 -o addr 
1: lo    inet 127.0.0.1/8 scope host lo\       valid_lft forever preferred_lft forever
2: enp2s0    inet 192.168.30.11/24 brd 192.168.30.255 scope global enp2s0\       valid_lft forever preferred_lft forever
2: enp2s0    inet 192.168.30.13/24 brd 192.168.30.255 scope global secondary noprefixroute enp2s0\       valid_lft forever preferred_lft forever
4: docker0    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0\       valid_lft forever preferred_lft forever
45: br-a32fa1ca1437    inet 172.18.0.1/16 brd 172.18.255.255 scope global br-a32fa1ca1437\       valid_lft forever preferred_lft forever
71: br-2bb2f800fb7a    inet 172.20.0.1/16 brd 172.20.255.255 scope global br-2bb2f800fb7a\       valid_lft forever preferred_lft forever
120: br-fc7ddec9d410    inet 172.21.0.1/16 brd 172.21.255.255 scope global br-fc7ddec9d410\       valid_lft forever preferred_lft forever
399: br-a82ea0e05c7b    inet 172.26.0.1/16 brd 172.26.255.255 scope global br-a82ea0e05c7b\       valid_lft forever preferred_lft forever
149: br-6d50d8b97aac    inet 172.22.0.1/16 brd 172.22.255.255 scope global br-6d50d8b97aac\       valid_lft forever preferred_lft forever
1209: br-2eeefaf97995    inet 172.28.0.1/16 brd 172.28.255.255 scope global br-2eeefaf97995\       valid_lft forever preferred_lft forever
185: br-3a54bbf16bd3    inet 172.24.0.1/16 brd 172.24.255.255 scope global br-3a54bbf16bd3\       valid_lft forever preferred_lft forever
717: br-f5d2855f7db6    inet 172.19.0.1/16 brd 172.19.255.255 scope global br-f5d2855f7db6\       valid_lft forever preferred_lft forever
206: br-33100abbf284    inet 172.25.0.1/16 brd 172.25.255.255 scope global br-33100abbf284\       valid_lft forever preferred_lft forever
734: br-92f61288b627    inet 172.23.0.1/16 brd 172.23.255.255 scope global br-92f61288b627\       valid_lft forever preferred_lft forever
482: br-469d326ed73c    inet 172.27.0.1/16 brd 172.27.255.255 scope global br-469d326ed73c\       valid_lft forever preferred_lft forever			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="table"></a>11.10.7.13. 策略路由</h4></div></div></div>
			
			<pre class="screen">
		
比如我们的LINUX有3个网卡
eth0: 192.168.1.1　　　（局域网）
eth1: 172.17.1.2　　　 （default gw=172.17.1.1，可以上INTERNET）
eth2: 192.168.10.2　　 （连接第二路由192.168.10.1，也可以上INTERNET）

实现两个目的
1、让192.168.1.66从第二路由上网，其他人走默认路由
2、让所有人访问192.168.1.1的FTP时，转到192.168.10.96上

配置方法：
vi /etc/iproute2/rt_tables

#
# reserved values
#
255     local
254     main
253     default
100     ROUTE2

# ip route default via 172.17.1.1 dev eth1
# ip route default via 192.168.10.1 dev eth2 table ROUTE2
# ip rule add from 192.168.1.66 pref 1001 table ROUTE2
# ip rule add to 192.168.10.96 pref 1002 table ROUTE2
# echo 1 &gt;; /proc/sys/net/ipv4/ip_forward
# iptables -t nat -A POSTROUTING -j MASQUERADE
# iptables -t nat -A PREROUTING -d 192.168.1.1 -p tcp --dport 21 -j DNAT --to 192.168.10.96
# ip route flush cache	
		
			</pre>
			<pre class="screen">
		
http://phorum.study-area.org/viewtopic.php?t=10085
引用：# 對外網卡 
EXT_IF="eth0" 
      
# HiNet IP 
EXT_IP1="111.111.111.111" 
EXT_MASK1="24" 
GW1="111.111.111.1" 

# SeedNet IP 
EXT_IP2="222.222.222.222" 
EXT_MASK2="24" 
GW2="222.222.222.1" 

# ?#93;定 ip 
ip addr add $EXT_IP1/$EXT_MASK1 dev $EXT_IF 
ip addr add $EXT_IP2/$EXT_MASK2 dev $EXT_IF 

# ?#93;定 HiNet routing 
ip rule add to $EXT_IP1/$EXT_MASK1 lookup 201 
ip route add default via $GW1 dev $EXT_IF table 201 

# ?#93;定 SeedNet routing 
ip rule add to $EXT_IP2/$EXT_MASK2 lookup 202 
ip route add default via $GW2 dev $EXT_IF table 202 

# ?#93;定 Default route 
ip route replace default equalize \ 
   nexthop via $GW1 dev $EXT_IF \ 
   nexthop via $GW2 dev $EXT_IF 
    
# 清除 route cache 
ip route flush cache    


它这里的ip rule也是这么使用的		
		
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="nexthop"></a>11.10.7.14. 负载均衡</h4></div></div></div>
			
			<pre class="screen">
			ip route add default scope global nexthop dev ppp0 nexthop dev ppp1
		</pre>
			<pre class="screen">
			neo@debian:~$ sudo ip route add default scope global nexthop via 192.168.3.1 dev eth0 weight 1 \
			nexthop via 192.168.5.1 dev eth2 weight 1

			neo@debian:~$ sudo ip route
			192.168.5.0/24 dev eth1 proto kernel scope link src 192.168.5.9
			192.168.4.0/24 dev eth0 proto kernel scope link src 192.168.4.9
			192.168.3.0/24 dev eth0 proto kernel scope link src 192.168.3.9
			172.16.0.0/24 dev eth2 proto kernel scope link src 172.16.0.254
			default
			nexthop via 192.168.3.1 dev eth0 weight 1
			nexthop via 192.168.5.1 dev eth1
			weight 1

		</pre>
			<pre class="screen">
			ip route add default scope global nexthop via $P1 dev $IF1 weight 1 \
			nexthop via $P2 dev $IF2 weight 1
		</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="ppp.masq"></a>11.10.7.15. MASQUERADE</h4></div></div></div>
			
			<pre class="screen">
iptables–tnat–APOSTROUTING–d192.168.1.0/24–s0/0–oppp0–jMASQUERD
iptables–tnat–APOSTROUTING–s192.168.1.0/24-jSNAT–to202.103.224.58
iptables -t nat -A POSTROUTING -s 192.168.0.0/24 -j MASQUERADE
		</pre>
			<p></p>
			<pre class="screen">
#ip route add via ppp0 dev eth0
#ip route add via 202.103.224.58 dev eth0
		</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="iptunnel"></a>11.10.7.16. ip tunnel</h4></div></div></div>
			
			<p>ipip 是IP隧道模块</p>
			<div class="procedure"><a id="idm148155674672"></a><p class="title"><strong>过程 11.1. ip tunnel IP隧道配置步骤</strong></p><ol class="procedure" type="1"><li class="step">
					<p>server 1</p>
					<pre class="screen">
modprobe ipip
ip tunnel add mytun mode ipip remote 220.201.35.11 local 211.100.37.167 ttl 255
ifconfig mytun 10.42.1.1
route add -net 10.42.1.0/24 dev mytun
				</pre>
				</li><li class="step">
					<p>server 2</p>
					<pre class="screen">
modprobe ipip
ip tunnel add mytun mode ipip remote 211.100.37.167 local 220.201.35.11 ttl 255
ifconfig mytun 10.42.1.2
route add -net 10.42.1.0/24 dev mytun
				</pre>
				</li><li class="step">
					<p>nat</p>
					<pre class="screen">
/sbin/iptables -t nat -A POSTROUTING -s 10.42.1.0/24 -j MASQUERADE
/sbin/iptables -t nat -A POSTROUTING -s 211.100.37.0/24 -j MASQUERADE
				</pre>
				</li></ol></div>
			<p>删除路由表</p>
			<pre class="screen">
		
route del -net 10.42.1.0/24 dev mytun		
		
			</pre>
			<p>修改IP隧道的IP</p>
			<pre class="screen">
		
ifconfig mytun 10.10.10.220
route add -net 10.10.10.0/24 dev mytun		
		
			</pre>
			<p>ip 伪装</p>
			<pre class="screen">
		
/sbin/iptables -t nat -A POSTROUTING -s 10.10.10.0/24 -j MASQUERADE
		
			</pre>
		</div>
	</div>
	
	
	
	
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="vlan"></a>11.10.8. VLAN</h3></div></div></div>
		
		<p>首先需确保加载了内核模块 802.1q</p>
		<pre class="screen">
		
[root@development ~]# lsmod | grep 8021q
[root@development ~]# modprobe 8021q
		
		</pre>
		<p>加载后会生成目录/proc/net/vlan </p>
		<pre class="screen">
		
[root@development ~]# cat /proc/net/vlan/config
VLAN Dev name | VLAN ID
Name-Type: VLAN_NAME_TYPE_RAW_PLUS_VID_NO_PAD		
		
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="bridge"></a>11.10.9. 网桥</h3></div></div></div>
		
		<p>Linux 系统4个物理网卡的名称则分别为eth0，eth1，eth2，eth3。我们将四个网口桥接到br0端口。</p>
		<p>你可以这样理解 vlan 2, vlan ip 192.168.0.1，然后将4个接口划分到vlan2, 这时这4个接口可以通过vlan 2访问其他用户。我只是做了一个比喻，让你能够理解。</p>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155661648"></a>11.10.9.1. brctl</h4></div></div></div>
			
			<pre class="screen">
			
[root@localhost ~]# dnf -y install bridge-utils			
			
			</pre>
			<pre class="screen">
# brctl addbr br0

# brctl addif br0 eth0
# brctl addif br0 eth1
# brctl addif br0 eth2
# brctl addif br0 eth3

# ifconfig eth0 0.0.0.0
# ifconfig eth1 0.0.0.0
# ifconfig eth2 0.0.0.0
# ifconfig eth3 0.0.0.0

# ifconfig br0 192.168.0.1
		</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155659808"></a>11.10.9.2. bridge - show / manipulate bridge addresses and devices</h4></div></div></div>
			
			<pre class="screen">
			
[root@localhost ~]# bridge 
Usage: bridge [ OPTIONS ] OBJECT { COMMAND | help }
       bridge [ -force ] -batch filename
where	OBJECT := { link | fdb | mdb | vlan | monitor }
	OPTIONS := { -V[ersion] | -s[tatistics] | -d[etails] |
		     -o[neline] | -t[imestamp] | -n[etns] name |
		     -c[ompressvlans] -color -p[retty] -j[son] }
[root@localhost ~]# bridge link
16582: vethb1a595b@if16581: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 master br-ad3d9e94154d state forwarding priority 32 cost 2 
16586: veth1@veth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 master br0 state forwarding priority 32 cost 2 
16587: veth0@veth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 master br0 state forwarding priority 32 cost 2 			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155657760"></a>11.10.9.3. 创建网桥</h4></div></div></div>
			
			<pre class="screen">
			
ip link add name br0 type bridge
ip addr add 192.168.3.1/24 dev br0
ip link set br0 up			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155656400"></a>11.10.9.4. veth设备</h4></div></div></div>
			
			<pre class="screen">
			
[root@localhost ~]# ip link add name br0 type bridge
[root@localhost ~]# ip addr add 192.168.3.1/24 dev br0
[root@localhost ~]# ip link set br0 up

[root@localhost ~]# ifconfig br0
br0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.3.1  netmask 255.255.255.0  broadcast 0.0.0.0
        inet6 fe80::444c:55ff:fe96:d7dd  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 46:4c:55:96:d7:dd  txqueuelen 1000  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 6  bytes 516 (516.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0	

[root@localhost ~]# ip route
default via 192.168.30.1 dev enp2s0 proto static metric 100 
192.168.3.0/24 dev br0 proto kernel scope link src 192.168.3.1

[root@localhost ~]# ping -c 1 -I br0 192.168.3.1
PING 192.168.3.1 (192.168.3.1) from 192.168.3.1 br0: 56(84) bytes of data.
64 bytes from 192.168.3.1: icmp_seq=1 ttl=64 time=0.052 ms

--- 192.168.3.1 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.052/0.052/0.052/0.000 ms
			
			</pre>
			<pre class="screen">
			
ip link add veth0 type veth peer name veth1
ip addr add 192.168.3.11/24 dev veth0
ip addr add 192.168.3.12/24 dev veth1
ip link set veth0 up
ip link set veth1 up			
			
			</pre>
			<p>创建veth设备，并配置IP</p>
			<pre class="screen">
			
[root@localhost ~]# ip link add veth0 type veth peer name veth1
[root@localhost ~]# ip addr add 192.168.3.11/24 dev veth0
[root@localhost ~]# ip addr add 192.168.3.12/24 dev veth1
[root@localhost ~]# ip link set veth0 up
[root@localhost ~]# ip link set veth1 up

[root@localhost ~]# ifconfig veth0
veth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.3.11  netmask 255.255.255.0  broadcast 0.0.0.0
        inet6 fe80::849:3eff:fe7f:646f  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 0a:49:3e:7f:64:6f  txqueuelen 1000  (Ethernet)
        RX packets 7  bytes 586 (586.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 7  bytes 586 (586.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

[root@localhost ~]# ifconfig veth1
veth1: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.3.12  netmask 255.255.255.0  broadcast 0.0.0.0
        inet6 fe80::a0ec:9fff:feb2:d8ff  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether a2:ec:9f:b2:d8:ff  txqueuelen 1000  (Ethernet)
        RX packets 7  bytes 586 (586.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 7  bytes 586 (586.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
        
[root@localhost ~]# ip route
default via 192.168.30.1 dev enp2s0 proto static metric 100 
192.168.3.0/24 dev br0 proto kernel scope link src 192.168.3.1 
192.168.3.0/24 dev veth0 proto kernel scope link src 192.168.3.11 
192.168.3.0/24 dev veth1 proto kernel scope link src 192.168.3.12         
			
			</pre>
			<p></p>
			<pre class="screen">
			
[root@localhost ~]# ip link set dev veth0 master br0	
[root@localhost ~]# ip link set dev veth1 master br0	

[root@localhost ~]# bridge link
16582: vethb1a595b@if16581: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 master br-ad3d9e94154d state forwarding priority 32 cost 2 
16586: veth1@veth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 master br0 state forwarding priority 32 cost 2 
16587: veth0@veth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 master br0 state forwarding priority 32 cost 2 			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155652640"></a>11.10.9.5. 打通两个 namespace 之间的 veth</h4></div></div></div>
			
			<pre class="screen">
			
# 创建 namespace
ip netns a ns1
ip netns a ns2

# 创建一对 veth-pair veth0 veth1
ip link add veth0 type veth peer name veth1

# 将 veth0 veth1 分别加入两个 ns
ip link set veth0 netns ns1
ip link set veth1 netns ns2	

# 给两个 veth0 veth1 配上 IP 并启用
ip netns exec ns1 ip addr add 192.168.3.11/24 dev veth0
ip netns exec ns1 ip link set veth0 up

ip netns exec ns2 ip addr add 192.168.3.12/24 dev veth1
ip netns exec ns2 ip link set veth1 up

# 从 veth0 ping veth1
[root@localhost ~]# ip netns exec ns1 ping -c 3 192.168.3.12
PING 192.168.3.12 (192.168.3.12) 56(84) bytes of data.
64 bytes from 192.168.3.12: icmp_seq=1 ttl=64 time=0.025 ms
64 bytes from 192.168.3.12: icmp_seq=2 ttl=64 time=0.019 ms
64 bytes from 192.168.3.12: icmp_seq=3 ttl=64 time=0.022 ms

--- 192.168.3.12 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2025ms
rtt min/avg/max/mdev = 0.019/0.022/0.025/0.002 ms
			
			</pre>
			<p></p>
			<pre class="screen">
			
[root@localhost ~]# ip netns a ns1
[root@localhost ~]# ip netns a ns2			
[root@localhost ~]# ip netns 
ns2 (id: 2)
ns1 (id: 1)			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155649408"></a>11.10.9.6. 通过网桥连接 veth-pair</h4></div></div></div>
			
			<pre class="screen">
			
#创建 bridge br0			
ip link add name br0 type bridge
ip addr add 192.168.3.1/24 dev br0
ip link set br0 up

# 创建两对 veth-pair
ip l a veth0 type veth peer name br-veth0
ip l a veth1 type veth peer name br-veth1




# 分别将两对 veth-pair 加入两个 ns 和 br0
ip l s veth0 netns ns1
ip l s br-veth0 master br0
ip addr add 192.168.3.10/24 dev br-veth0
ip l s br-veth0 up

ip l s veth1 netns ns2
ip l s br-veth1 master br0
ip l s br-veth1 up

# 给两个 ns 中的 veth 配置 IP 并启用
ip netns exec ns1 ip a a 10.1.1.2/24 dev veth0
ip netns exec ns1 ip l s veth0 up

ip netns exec ns2 ip a a 10.1.1.3/24 dev veth1
ip netns exec ns2 ip l s veth1 up

# veth0 ping veth1
[root@localhost ~]# ip netns exec ns1 ping -c 3 192.168.3.12
PING 192.168.3.12 (192.168.3.12) 56(84) bytes of data.
64 bytes from 192.168.3.12: icmp_seq=1 ttl=64 time=0.024 ms
64 bytes from 192.168.3.12: icmp_seq=2 ttl=64 time=0.017 ms
64 bytes from 192.168.3.12: icmp_seq=3 ttl=64 time=0.014 ms

--- 192.168.3.12 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2065ms
rtt min/avg/max/mdev = 0.014/0.018/0.024/0.005 ms
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm148155648256"></a>11.10.9.7. 添加设备到网桥</h4></div></div></div>
			
			<p>添加物理设备</p>
			<pre class="screen">
			
ip link set dev eth0 master br0			
			
			</pre>
			<p>添加虚拟设备</p>
			<pre class="screen">
			
ip link set dev veth0 master br0			
			
			</pre>
			<p></p>
			<pre class="screen">
			
[root@localhost ~]# ip link set dev veth0 master br0
[root@localhost ~]# ip link set dev veth1 master br0

[root@localhost ~]# ip route
default via 192.168.30.1 dev enp2s0 proto static metric 100 
192.168.3.0/24 dev br0 proto kernel scope link src 192.168.3.1 
192.168.3.0/24 dev veth0 proto kernel scope link src 192.168.3.11 
192.168.3.0/24 dev veth1 proto kernel scope link src 192.168.3.12 

[root@localhost ~]# bridge link
16586: veth1@veth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 master br0 state forwarding priority 32 cost 2 
16587: veth0@veth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 master br0 state forwarding priority 32 cost 2 			
			
			</pre>
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="zebra"></a>11.10.10. Zebra</h3></div></div></div>
		
		<p>http://www.zebra.org/</p>
	</div>
</div><div xmlns="" id="SOHUCS"></div><script xmlns="" charset="utf-8" type="text/javascript" src="https://cy-cdn.kuaizhan.com/upload/changyan.js"></script><script xmlns="" type="text/javascript">
window.changyan.api.config({
appid: 'cyvwjQUG3',
conf: 'prod_ef966242df3d8b5acb1e0ee9fc01cafe'
});
</script><script xmlns="" type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?u=r5HG&amp;d=9mi5r_kkDC8uxG8HuY3p4-2qgeeVypAK9vMD-2P6BYM"></script><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="wireless.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="index.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="linux.network.old.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">11.9. Wireless - WiFi 配置 </td><td width="20%" align="center"><a accesskey="h" href="../../index.html">起始页</a></td><td width="40%" align="right" valign="top"> 11.11. 早期版本</td></tr></table></div><script xmlns="">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11694057-1', 'auto');
  ga('send', 'pageview');

</script><script xmlns="" async="async">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?93967759a51cda79e49bf4e34d0b0f2c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script xmlns="" async="async">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script></body></html>