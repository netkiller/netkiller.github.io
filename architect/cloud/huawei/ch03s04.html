<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>3.4.Â Ubuntu</title><link rel="stylesheet" type="text/css" href="../../docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="home" href="../../index.html" title="Netkiller Architect æ‰‹æœ­" /><link rel="up" href="index.html" title="ç¬¬Â 3Â ç« Â Huawei Cloud Service" /><link rel="prev" href="HuaweiCloudEulerOS.html" title="3.3.Â Huawei Cloud EulerOS" /><link rel="next" href="../../database/index.html" title="ç¬¬Â 4Â ç« Â æ•°æ®åº“è®¾è®¡" /></head><body><a xmlns="" href="//www.netkiller.cn/">Home</a> | <a xmlns="" href="//netkiller.github.io/">ç®€ä½“ä¸­æ–‡</a> | <a xmlns="" href="http://netkiller.sourceforge.net/">ç¹ä½“ä¸­æ–‡</a> | <a xmlns="" href="/journal/index.html">æ‚æ–‡</a>
		| <a xmlns="" href="https://github.com/netkiller">Github</a> | <a xmlns="" href="https://zhuanlan.zhihu.com/netkiller">çŸ¥ä¹ä¸“æ </a> | <a xmlns="" href="https://www.facebook.com/bg7nyt">Facebook</a> | <a xmlns="" href="http://cn.linkedin.com/in/netkiller/">Linkedin</a> | <a xmlns="" href="https://www.youtube.com/user/bg7nyt/videos">Youtube</a> | <a xmlns="" href="//www.netkiller.cn/home/donations.html">æ‰“èµ(Donations)</a> | <a xmlns="" href="//www.netkiller.cn/home/about.html">About</a><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">3.4.Â Ubuntu</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="HuaweiCloudEulerOS.html">ä¸Šä¸€é¡µ</a>Â </td><th width="60%" align="center">ç¬¬Â 3Â ç« Â Huawei Cloud Service</th><td width="20%" align="right">Â <a accesskey="n" href="../../database/index.html">ä¸‹ä¸€é¡µ</a></td></tr></table><hr /></div><table xmlns=""><tr><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=watch&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=fork&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;type=follow&amp;count=true&amp;size=large" height="30" width="240" frameborder="0" scrolling="0" style="width:240px; height: 30px;" allowTransparency="true"></iframe></td><td></td><td><a href="https://zhuanlan.zhihu.com/netkiller"><img src="/images/logo/zhihu-card-default.svg" height="25" /></a></td><td valign="middle"><a href="https://zhuanlan.zhihu.com/netkiller">çŸ¥ä¹ä¸“æ </a></td><td></td><td></td><td></td><td></td></tr></table><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="id1498"></a>3.4.Â Ubuntu</h2></div></div></div>
		
		<pre class="screen">
			
cat &gt;&gt; /etc/resolv.conf &lt;&lt;EOF
# Generated by NetworkManager
search netkillerc.cn
nameserver 114.114.114.114
nameserver 8.8.8.8
options timeout:1 single-request-reopen
EOF
			
		</pre>
		<pre class="screen">
		
root@netkiller:~# apt update -y
root@netkiller:~# apt upgrade -y	
root@netkiller:~# apt autoremove	-y
		
		</pre>
		
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1118"></a>3.4.1.Â Nvidia é©±åŠ¨</h3></div></div></div>
			
			<pre class="screen">
			
root@netkiller:~# ubuntu-drivers devices
ERROR:root:aplay command not found
== /sys/devices/pci0000:00/0000:00:0d.0 ==
modalias : pci:v000010DEd00001EB8sv000010DEsd000012A2bc03sc02i00
vendor   : NVIDIA Corporation
model    : TU104GL [Tesla T4]
driver   : nvidia-driver-418-server - distro non-free
driver   : nvidia-driver-535-server - distro non-free
driver   : nvidia-driver-470 - distro non-free
driver   : nvidia-driver-545 - distro non-free
driver   : nvidia-driver-535 - distro non-free recommended
driver   : nvidia-driver-570-server - distro non-free
driver   : nvidia-driver-470-server - distro non-free
driver   : nvidia-driver-450-server - distro non-free
driver   : xserver-xorg-video-nouveau - distro free builtin			
			
			</pre>
			<p></p>
			<pre class="screen">
			
root@netkiller:~# apt install nvidia-driver-570-server
root@netkiller:~# prime-select nvidia 
			
			</pre>
			<pre class="screen">
			
sudo prime-select query //æŸ¥çœ‹å½“å‰ä½¿ç”¨æ˜¾å¡
sudo prime-select nvidia //ä½¿ç”¨nvidiaæ˜¾å¡
sudo prime-select intel //ä½¿ç”¨intelæ˜¾å¡			
			
			</pre>
			<pre class="screen">
			
root@netkiller:~# lsmod | grep nvidia
root@netkiller:~# modprobe nvidia
root@netkiller:~# lsmod | grep nvidia
nvidia_uvm           1781760  0
nvidia_drm            110592  0
nvidia_modeset       1527808  1 nvidia_drm
nvidia              89739264  2 nvidia_uvm,nvidia_modeset
drm_kms_helper        311296  4 cirrus,nvidia_drm
drm                   622592  5 drm_kms_helper,nvidia,cirrus,nvidia_drm			
			
			</pre>
			<p></p>
			<pre class="screen">
			
apt install nvidia-utils-550		
			
			</pre>
			<p></p>
			<pre class="screen">
			
root@netkiller:~# nvidia-smi
Fri Mar 14 17:50:55 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.86.15              Driver Version: 570.86.15      CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla T4                       Off |   00000000:00:0D.0 Off |                    0 |
| N/A   65C    P0             31W /   70W |       1MiB /  15360MiB |      8%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+			
			
			</pre>

			<p></p>
			<pre class="programlisting">
			
root@netkiller:~# /srv/python/bin/python
Python 3.11.0rc1 (main, Aug 12 2022, 10:02:14) [GCC 11.2.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; import torch
&gt;&gt;&gt; torch.cuda.is_available()
True
&gt;&gt;&gt; 			
			
			</pre>
			<p></p>
			<pre class="screen">
			
root@netkiller:~# gpu-manager
last_boot_file: /var/lib/ubuntu-drivers-common/last_gfx_boot
new_boot_file: /var/lib/ubuntu-drivers-common/last_gfx_boot
can't access /opt/amdgpu-pro/bin/amdgpu-pro-px
Looking for nvidia modules in /lib/modules/5.15.0-134-generic/kernel
Looking for nvidia modules in /lib/modules/5.15.0-134-generic/updates/dkms
Found nvidia.ko module in /lib/modules/5.15.0-134-generic/updates/dkms/nvidia.ko
Looking for amdgpu modules in /lib/modules/5.15.0-134-generic/kernel
Looking for amdgpu modules in /lib/modules/5.15.0-134-generic/updates/dkms
Is nvidia loaded? yes
Was nvidia unloaded? no
Is nvidia blacklisted? no
Is intel loaded? no
Is radeon loaded? no
Is radeon blacklisted? no
Is amdgpu loaded? no
Is amdgpu blacklisted? no
Is amdgpu versioned? no
Is amdgpu pro stack? no
Is nouveau loaded? no
Is nouveau blacklisted? yes
Is nvidia kernel module available? yes
Is amdgpu kernel module available? no
Vendor/Device Id: 1013:b8
BusID "PCI:0@0:2:0"
Is boot vga? yes
Vendor/Device Id: 10de:1eb8
BusID "PCI:0@0:13:0"
can't open /sys/bus/pci/devices/0000:00:0d.0/boot_vga
Is boot vga? no
can't open /sys/bus/pci/devices/0000:00:0d.0/boot_vga
Chassis type: "1"
Laptop not detected
Is nvidia runtime pm supported for "0x1eb8"? no
Checking power status in /proc/driver/nvidia/gpus/0000:00:0d.0/power
Runtime D3 status:          ?
Is nvidia runtime pm enabled for "0x1eb8"? no
Takes 0ms to wait for nvidia udev rules completed.
Skipping "/dev/dri/card1", driven by "nvidia-drm"
Skipping "/dev/dri/card0", driven by "cirrus"
Skipping "/dev/dri/card1", driven by "nvidia-drm"
Skipping "/dev/dri/card0", driven by "cirrus"
Skipping "/dev/dri/card1", driven by "nvidia-drm"
Skipping "/dev/dri/card0", driven by "cirrus"
Skipping "/dev/dri/card1", driven by "nvidia-drm"
Skipping "/dev/dri/card0", driven by "cirrus"
Does it require offloading? no
last cards number = 2
Has amd? no
Has intel? no
Has nvidia? yes
How many cards? 2
Has the system changed? No
Unsupported discrete card vendor: 10de
Nothing to do			
			
			</pre>
			<p></p>
			<pre class="screen">
			
root@netkiller:~# apt install nvidia-cuda-toolkit			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="id1119"></a>3.4.2.Â Python ç¯å¢ƒ</h3></div></div></div>
			
			<pre class="screen">
			
cat &gt;&gt; requirements.txt &lt;&lt; EOF
ultralytics
onnx
numpy
matplotlib
opencv-python
opencv-python-headless
pillow
httpx
texttable
dominate
EOF
			
			</pre>
			<p></p>
			<pre class="screen">
			
root@netkiller:~# apt install python3.11 python3.11-venv 
root@netkiller:~# python3.11 -m venv /srv/python
root@netkiller:~# /srv/python/bin/pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu126 -i https://pypi.tuna.tsinghua.edu.cn/simple
root@netkiller:~# /srv/python/bin/pip3 install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple	
			
			</pre>
			<p></p>
			<pre class="screen">
			
import torch
torch.cuda.is_available()		
			
			</pre>
			<p></p>
			<pre class="screen">
			
root@netkiller:/opt/åŸå›¾è®­ç»ƒæ•°æ®# /srv/python/bin/yolo task=detect mode=train model=/srv/medical/model/yolo11m.pt data=/opt/datasets/AllInOne/data.yaml epochs=300 device=0 name=AllInOne project=runs
Ultralytics 8.3.89 ğŸš€ Python-3.11.0rc1 torch-2.6.0+cu124 CUDA:0 (Tesla T4, 14914MiB)			
			
			</pre>
		</div>
	</div><script xmlns="" type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?u=r5HG&amp;d=9mi5r_kkDC8uxG8HuY3p4-2qgeeVypAK9vMD-2P6BYM"></script><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="HuaweiCloudEulerOS.html">ä¸Šä¸€é¡µ</a>Â </td><td width="20%" align="center"><a accesskey="u" href="index.html">ä¸Šä¸€çº§</a></td><td width="40%" align="right">Â <a accesskey="n" href="../../database/index.html">ä¸‹ä¸€é¡µ</a></td></tr><tr><td width="40%" align="left" valign="top">3.3.Â Huawei Cloud EulerOSÂ </td><td width="20%" align="center"><a accesskey="h" href="../../index.html">èµ·å§‹é¡µ</a></td><td width="40%" align="right" valign="top">Â ç¬¬Â 4Â ç« Â æ•°æ®åº“è®¾è®¡</td></tr></table></div><script xmlns="">
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-11694057-1', 'auto');
			ga('send', 'pageview');

		</script><script xmlns="" async="async">
			var _hmt = _hmt || [];
			(function() {
			var hm = document.createElement("script");
			hm.src = "https://hm.baidu.com/hm.js?93967759a51cda79e49bf4e34d0b0f2c";
			var s = document.getElementsByTagName("script")[0];
			s.parentNode.insertBefore(hm, s);
			})();
</script><script xmlns="" async="async">
			(function(){
			var bp = document.createElement('script');
			var curProtocol = window.location.protocol.split(':')[0];
			if (curProtocol === 'https') {
			bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
			}
			else {
			bp.src = 'http://push.zhanzhang.baidu.com/push.js';
			}
			var s = document.getElementsByTagName("script")[0];
			s.parentNode.insertBefore(bp, s);
			})();
</script></body></html>